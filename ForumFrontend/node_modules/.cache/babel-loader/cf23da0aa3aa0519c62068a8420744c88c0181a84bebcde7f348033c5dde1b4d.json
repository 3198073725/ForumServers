{"ast":null,"code":"'use strict';\n\nrequire(\"core-js/modules/es.array.every.js\");\nrequire(\"core-js/modules/es.array.slice.js\");\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.every.js\");\nrequire(\"core-js/modules/es.number.is-nan.js\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar shared = require('@vue/shared');\nvar error = require('../../../../utils/error.js');\nvar types = require('../../../../utils/types.js');\nvar event = require('../../../../constants/event.js');\nvar useWatch = function useWatch(props, initData, minValue, maxValue, emit, elFormItem) {\n  var _emit = function _emit(val) {\n    emit(event.UPDATE_MODEL_EVENT, val);\n    emit(event.INPUT_EVENT, val);\n  };\n  var valueChanged = function valueChanged() {\n    if (props.range) {\n      return ![minValue.value, maxValue.value].every(function (item, index) {\n        return item === initData.oldValue[index];\n      });\n    } else {\n      return props.modelValue !== initData.oldValue;\n    }\n  };\n  var setValues = function setValues() {\n    var _a, _b;\n    if (props.min > props.max) {\n      error.throwError(\"Slider\", \"min should not be greater than max.\");\n    }\n    var val = props.modelValue;\n    if (props.range && shared.isArray(val)) {\n      if (val[1] < props.min) {\n        _emit([props.min, props.min]);\n      } else if (val[0] > props.max) {\n        _emit([props.max, props.max]);\n      } else if (val[0] < props.min) {\n        _emit([props.min, val[1]]);\n      } else if (val[1] > props.max) {\n        _emit([val[0], props.max]);\n      } else {\n        initData.firstValue = val[0];\n        initData.secondValue = val[1];\n        if (valueChanged()) {\n          if (props.validateEvent) {\n            (_a = elFormItem == null ? void 0 : elFormItem.validate) == null ? void 0 : _a.call(elFormItem, \"change\")[\"catch\"](function (err) {\n              return error.debugWarn(err);\n            });\n          }\n          initData.oldValue = val.slice();\n        }\n      }\n    } else if (!props.range && types.isNumber(val) && !Number.isNaN(val)) {\n      if (val < props.min) {\n        _emit(props.min);\n      } else if (val > props.max) {\n        _emit(props.max);\n      } else {\n        initData.firstValue = val;\n        if (valueChanged()) {\n          if (props.validateEvent) {\n            (_b = elFormItem == null ? void 0 : elFormItem.validate) == null ? void 0 : _b.call(elFormItem, \"change\")[\"catch\"](function (err) {\n              return error.debugWarn(err);\n            });\n          }\n          initData.oldValue = val;\n        }\n      }\n    }\n  };\n  setValues();\n  vue.watch(function () {\n    return initData.dragging;\n  }, function (val) {\n    if (!val) {\n      setValues();\n    }\n  });\n  vue.watch(function () {\n    return props.modelValue;\n  }, function (val, oldVal) {\n    if (initData.dragging || shared.isArray(val) && shared.isArray(oldVal) && val.every(function (item, index) {\n      return item === oldVal[index];\n    }) && initData.firstValue === val[0] && initData.secondValue === val[1]) {\n      return;\n    }\n    setValues();\n  }, {\n    deep: true\n  });\n  vue.watch(function () {\n    return [props.min, props.max];\n  }, function () {\n    setValues();\n  });\n};\nexports.useWatch = useWatch;","map":{"version":3,"names":["useWatch","props","initData","minValue","maxValue","emit","elFormItem","_emit","val","event","UPDATE_MODEL_EVENT","INPUT_EVENT","valueChanged","range","value","every","item","index","oldValue","modelValue","setValues","_a","_b","min","max","error","throwError","shared","isArray","firstValue","secondValue","validateEvent","validate","call","err","debugWarn","slice","types","isNumber","Number","isNaN","vue","watch","dragging","oldVal","deep"],"sources":["../../../../../../../packages/components/slider/src/composables/use-watch.ts"],"sourcesContent":["import { watch } from 'vue'\nimport { INPUT_EVENT, UPDATE_MODEL_EVENT } from '@element-plus/constants'\nimport { debugWarn, isArray, isNumber, throwError } from '@element-plus/utils'\nimport type { ComputedRef, SetupContext } from 'vue'\nimport type { Arrayable } from '@element-plus/utils'\nimport type { FormItemContext } from '@element-plus/components/form'\nimport type { SliderEmits, SliderInitData, SliderProps } from '../slider'\n\nexport const useWatch = (\n  props: SliderProps,\n  initData: SliderInitData,\n  minValue: ComputedRef<number>,\n  maxValue: ComputedRef<number>,\n  emit: SetupContext<SliderEmits>['emit'],\n  elFormItem: FormItemContext\n) => {\n  const _emit = (val: Arrayable<number>) => {\n    emit(UPDATE_MODEL_EVENT, val)\n    emit(INPUT_EVENT, val)\n  }\n\n  const valueChanged = () => {\n    if (props.range) {\n      return ![minValue.value, maxValue.value].every(\n        (item, index) => item === (initData.oldValue as number[])[index]\n      )\n    } else {\n      return props.modelValue !== initData.oldValue\n    }\n  }\n\n  const setValues = () => {\n    if (props.min > props.max) {\n      throwError('Slider', 'min should not be greater than max.')\n    }\n    const val = props.modelValue\n    if (props.range && isArray(val)) {\n      if (val[1] < props.min) {\n        _emit([props.min, props.min])\n      } else if (val[0] > props.max) {\n        _emit([props.max, props.max])\n      } else if (val[0] < props.min) {\n        _emit([props.min, val[1]])\n      } else if (val[1] > props.max) {\n        _emit([val[0], props.max])\n      } else {\n        initData.firstValue = val[0]\n        initData.secondValue = val[1]\n        if (valueChanged()) {\n          if (props.validateEvent) {\n            elFormItem?.validate?.('change').catch((err) => debugWarn(err))\n          }\n          initData.oldValue = val.slice()\n        }\n      }\n    } else if (!props.range && isNumber(val) && !Number.isNaN(val)) {\n      if (val < props.min) {\n        _emit(props.min)\n      } else if (val > props.max) {\n        _emit(props.max)\n      } else {\n        initData.firstValue = val\n        if (valueChanged()) {\n          if (props.validateEvent) {\n            elFormItem?.validate?.('change').catch((err) => debugWarn(err))\n          }\n          initData.oldValue = val\n        }\n      }\n    }\n  }\n\n  setValues()\n\n  watch(\n    () => initData.dragging,\n    (val) => {\n      if (!val) {\n        setValues()\n      }\n    }\n  )\n\n  watch(\n    () => props.modelValue,\n    (val, oldVal) => {\n      if (\n        initData.dragging ||\n        (isArray(val) &&\n          isArray(oldVal) &&\n          val.every((item, index) => item === oldVal[index]) &&\n          initData.firstValue === val[0] &&\n          initData.secondValue === val[1])\n      ) {\n        return\n      }\n      setValues()\n    },\n    {\n      deep: true,\n    }\n  )\n\n  watch(\n    () => [props.min, props.max],\n    () => {\n      setValues()\n    }\n  )\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}