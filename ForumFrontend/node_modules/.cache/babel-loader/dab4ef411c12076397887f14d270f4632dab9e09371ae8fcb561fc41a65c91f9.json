{"ast":null,"code":"'use strict';\n\nvar _toConsumableArray = require(\"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/toConsumableArray.js\")[\"default\"];\nvar _slicedToArray = require(\"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/slicedToArray.js\")[\"default\"];\nvar _typeof = require(\"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/typeof.js\")[\"default\"];\nrequire(\"core-js/modules/es.array.concat.js\");\nrequire(\"core-js/modules/es.array.map.js\");\nrequire(\"core-js/modules/es.array.slice.js\");\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar dayjs = require('dayjs');\nvar localeData = require('dayjs/plugin/localeData.js');\nvar dateTable = require('./date-table.js');\nvar date = require('../../../constants/date.js');\nvar index = require('../../../hooks/use-locale/index.js');\nvar utils = require('../../time-picker/src/utils.js');\nfunction _interopDefaultLegacy(e) {\n  return e && _typeof(e) === 'object' && 'default' in e ? e : {\n    'default': e\n  };\n}\nvar dayjs__default = /*#__PURE__*/_interopDefaultLegacy(dayjs);\nvar localeData__default = /*#__PURE__*/_interopDefaultLegacy(localeData);\nvar useDateTable = function useDateTable(props, emit) {\n  dayjs__default[\"default\"].extend(localeData__default[\"default\"]);\n  var firstDayOfWeek = dayjs__default[\"default\"].localeData().firstDayOfWeek();\n  var _index$useLocale = index.useLocale(),\n    t = _index$useLocale.t,\n    lang = _index$useLocale.lang;\n  var now = dayjs__default[\"default\"]().locale(lang.value);\n  var isInRange = vue.computed(function () {\n    return !!props.range && !!props.range.length;\n  });\n  var rows = vue.computed(function () {\n    var days = [];\n    if (isInRange.value) {\n      var _props$range = _slicedToArray(props.range, 2),\n        start = _props$range[0],\n        end = _props$range[1];\n      var currentMonthRange = utils.rangeArr(end.date() - start.date() + 1).map(function (index) {\n        return {\n          text: start.date() + index,\n          type: \"current\"\n        };\n      });\n      var remaining = currentMonthRange.length % 7;\n      remaining = remaining === 0 ? 0 : 7 - remaining;\n      var nextMonthRange = utils.rangeArr(remaining).map(function (_, index) {\n        return {\n          text: index + 1,\n          type: \"next\"\n        };\n      });\n      days = currentMonthRange.concat(nextMonthRange);\n    } else {\n      var firstDay = props.date.startOf(\"month\").day();\n      var prevMonthDays = dateTable.getPrevMonthLastDays(props.date, (firstDay - firstDayOfWeek + 7) % 7).map(function (day) {\n        return {\n          text: day,\n          type: \"prev\"\n        };\n      });\n      var currentMonthDays = dateTable.getMonthDays(props.date).map(function (day) {\n        return {\n          text: day,\n          type: \"current\"\n        };\n      });\n      days = [].concat(_toConsumableArray(prevMonthDays), _toConsumableArray(currentMonthDays));\n      var _remaining = 7 - (days.length % 7 || 7);\n      var nextMonthDays = utils.rangeArr(_remaining).map(function (_, index) {\n        return {\n          text: index + 1,\n          type: \"next\"\n        };\n      });\n      days = days.concat(nextMonthDays);\n    }\n    return dateTable.toNestedArr(days);\n  });\n  var weekDays = vue.computed(function () {\n    var start = firstDayOfWeek;\n    if (start === 0) {\n      return date.WEEK_DAYS.map(function (_) {\n        return t(\"el.datepicker.weeks.\".concat(_));\n      });\n    } else {\n      return date.WEEK_DAYS.slice(start).concat(date.WEEK_DAYS.slice(0, start)).map(function (_) {\n        return t(\"el.datepicker.weeks.\".concat(_));\n      });\n    }\n  });\n  var getFormattedDate = function getFormattedDate(day, type) {\n    switch (type) {\n      case \"prev\":\n        return props.date.startOf(\"month\").subtract(1, \"month\").date(day);\n      case \"next\":\n        return props.date.startOf(\"month\").add(1, \"month\").date(day);\n      case \"current\":\n        return props.date.date(day);\n    }\n  };\n  var handlePickDay = function handlePickDay(_ref) {\n    var text = _ref.text,\n      type = _ref.type;\n    var date = getFormattedDate(text, type);\n    emit(\"pick\", date);\n  };\n  var getSlotData = function getSlotData(_ref2) {\n    var text = _ref2.text,\n      type = _ref2.type;\n    var day = getFormattedDate(text, type);\n    return {\n      isSelected: day.isSame(props.selectedDay),\n      type: \"\".concat(type, \"-month\"),\n      day: day.format(\"YYYY-MM-DD\"),\n      date: day.toDate()\n    };\n  };\n  return {\n    now: now,\n    isInRange: isInRange,\n    rows: rows,\n    weekDays: weekDays,\n    getFormattedDate: getFormattedDate,\n    handlePickDay: handlePickDay,\n    getSlotData: getSlotData\n  };\n};\nexports.useDateTable = useDateTable;","map":{"version":3,"names":["useDateTable","props","emit","dayjs__default","extend","localeData__default","firstDayOfWeek","localeData","_index$useLocale","index","useLocale","t","lang","now","locale","value","isInRange","vue","computed","range","length","rows","days","_props$range","_slicedToArray","start","end","currentMonthRange","utils","rangeArr","date","map","text","type","remaining","nextMonthRange","_","concat","firstDay","startOf","day","prevMonthDays","dateTable","getPrevMonthLastDays","currentMonthDays","getMonthDays","_toConsumableArray","nextMonthDays","toNestedArr","weekDays","WEEK_DAYS","slice","getFormattedDate","subtract","add","handlePickDay","_ref","getSlotData","_ref2","isSelected","isSame","selectedDay","format","toDate"],"sources":["../../../../../../packages/components/calendar/src/use-date-table.ts"],"sourcesContent":["import { computed } from 'vue'\nimport dayjs from 'dayjs'\nimport localeData from 'dayjs/plugin/localeData.js'\nimport { useLocale } from '@element-plus/hooks'\nimport { rangeArr } from '@element-plus/components/time-picker'\nimport { WEEK_DAYS } from '@element-plus/constants'\nimport { getMonthDays, getPrevMonthLastDays, toNestedArr } from './date-table'\n\nimport type { SetupContext } from 'vue'\nimport type { Dayjs } from 'dayjs'\nimport type {\n  CalendarDateCell,\n  CalendarDateCellType,\n  DateTableEmits,\n  DateTableProps,\n} from './date-table'\n\nexport const useDateTable = (\n  props: DateTableProps,\n  emit: SetupContext<DateTableEmits>['emit']\n) => {\n  dayjs.extend(localeData)\n  // https://day.js.org/docs/en/i18n/locale-data\n  const firstDayOfWeek: number = dayjs.localeData().firstDayOfWeek()\n\n  const { t, lang } = useLocale()\n  const now = dayjs().locale(lang.value)\n\n  const isInRange = computed(() => !!props.range && !!props.range.length)\n\n  const rows = computed(() => {\n    let days: CalendarDateCell[] = []\n    if (isInRange.value) {\n      const [start, end] = props.range!\n      const currentMonthRange: CalendarDateCell[] = rangeArr(\n        end.date() - start.date() + 1\n      ).map((index) => ({\n        text: start.date() + index,\n        type: 'current',\n      }))\n\n      let remaining = currentMonthRange.length % 7\n      remaining = remaining === 0 ? 0 : 7 - remaining\n      const nextMonthRange: CalendarDateCell[] = rangeArr(remaining).map(\n        (_, index) => ({\n          text: index + 1,\n          type: 'next',\n        })\n      )\n      days = currentMonthRange.concat(nextMonthRange)\n    } else {\n      const firstDay = props.date.startOf('month').day()\n      const prevMonthDays: CalendarDateCell[] = getPrevMonthLastDays(\n        props.date,\n        (firstDay - firstDayOfWeek + 7) % 7\n      ).map((day) => ({\n        text: day,\n        type: 'prev',\n      }))\n      const currentMonthDays: CalendarDateCell[] = getMonthDays(props.date).map(\n        (day) => ({\n          text: day,\n          type: 'current',\n        })\n      )\n      days = [...prevMonthDays, ...currentMonthDays]\n      const remaining = 7 - (days.length % 7 || 7)\n      const nextMonthDays: CalendarDateCell[] = rangeArr(remaining).map(\n        (_, index) => ({\n          text: index + 1,\n          type: 'next',\n        })\n      )\n      days = days.concat(nextMonthDays)\n    }\n    return toNestedArr(days)\n  })\n\n  const weekDays = computed(() => {\n    const start = firstDayOfWeek\n    if (start === 0) {\n      return WEEK_DAYS.map((_) => t(`el.datepicker.weeks.${_}`))\n    } else {\n      return WEEK_DAYS.slice(start)\n        .concat(WEEK_DAYS.slice(0, start))\n        .map((_) => t(`el.datepicker.weeks.${_}`))\n    }\n  })\n\n  const getFormattedDate = (day: number, type: CalendarDateCellType): Dayjs => {\n    switch (type) {\n      case 'prev':\n        return props.date.startOf('month').subtract(1, 'month').date(day)\n      case 'next':\n        return props.date.startOf('month').add(1, 'month').date(day)\n      case 'current':\n        return props.date.date(day)\n    }\n  }\n\n  const handlePickDay = ({ text, type }: CalendarDateCell) => {\n    const date = getFormattedDate(text, type)\n    emit('pick', date)\n  }\n\n  const getSlotData = ({ text, type }: CalendarDateCell) => {\n    const day = getFormattedDate(text, type)\n    return {\n      isSelected: day.isSame(props.selectedDay),\n      type: `${type}-month`,\n      day: day.format('YYYY-MM-DD'),\n      date: day.toDate(),\n    }\n  }\n\n  return {\n    now,\n    isInRange,\n    rows,\n    weekDays,\n    getFormattedDate,\n    handlePickDay,\n    getSlotData,\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}