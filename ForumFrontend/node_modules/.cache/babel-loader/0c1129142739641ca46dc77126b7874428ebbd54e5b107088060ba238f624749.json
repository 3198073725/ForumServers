{"ast":null,"code":"'use strict';\n\nrequire(\"core-js/modules/es.array.filter.js\");\nrequire(\"core-js/modules/es.array.index-of.js\");\nrequire(\"core-js/modules/es.array.map.js\");\nrequire(\"core-js/modules/es.array.reverse.js\");\nrequire(\"core-js/modules/es.array.slice.js\");\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.filter.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar rovingFocusGroup = require('./roving-focus-group2.js');\nvar tokens = require('./tokens.js');\nvar utils = require('./utils.js');\nvar pluginVue_exportHelper = require('../../../_virtual/plugin-vue_export-helper.js');\nvar index = require('../../../hooks/use-id/index.js');\nvar event = require('../../../utils/dom/event.js');\nvar aria = require('../../../constants/aria.js');\nvar _sfc_main = vue.defineComponent({\n  components: {\n    ElRovingFocusCollectionItem: rovingFocusGroup.ElCollectionItem\n  },\n  props: {\n    focusable: {\n      type: Boolean,\n      \"default\": true\n    },\n    active: {\n      type: Boolean,\n      \"default\": false\n    }\n  },\n  emits: [\"mousedown\", \"focus\", \"keydown\"],\n  setup: function setup(props, _ref) {\n    var emit = _ref.emit;\n    var _vue$inject = vue.inject(tokens.ROVING_FOCUS_GROUP_INJECTION_KEY, void 0),\n      currentTabbedId = _vue$inject.currentTabbedId,\n      loop = _vue$inject.loop,\n      onItemFocus = _vue$inject.onItemFocus,\n      onItemShiftTab = _vue$inject.onItemShiftTab;\n    var _vue$inject2 = vue.inject(rovingFocusGroup.ROVING_FOCUS_COLLECTION_INJECTION_KEY, void 0),\n      getItems = _vue$inject2.getItems;\n    var id = index.useId();\n    var rovingFocusGroupItemRef = vue.ref();\n    var handleMousedown = event.composeEventHandlers(function (e) {\n      emit(\"mousedown\", e);\n    }, function (e) {\n      if (!props.focusable) {\n        e.preventDefault();\n      } else {\n        onItemFocus(vue.unref(id));\n      }\n    });\n    var handleFocus = event.composeEventHandlers(function (e) {\n      emit(\"focus\", e);\n    }, function () {\n      onItemFocus(vue.unref(id));\n    });\n    var handleKeydown = event.composeEventHandlers(function (e) {\n      emit(\"keydown\", e);\n    }, function (e) {\n      var code = e.code,\n        shiftKey = e.shiftKey,\n        target = e.target,\n        currentTarget = e.currentTarget;\n      if (code === aria.EVENT_CODE.tab && shiftKey) {\n        onItemShiftTab();\n        return;\n      }\n      if (target !== currentTarget) return;\n      var focusIntent = utils.getFocusIntent(e);\n      if (focusIntent) {\n        e.preventDefault();\n        var items = getItems().filter(function (item) {\n          return item.focusable;\n        });\n        var elements = items.map(function (item) {\n          return item.ref;\n        });\n        switch (focusIntent) {\n          case \"last\":\n            {\n              elements.reverse();\n              break;\n            }\n          case \"prev\":\n          case \"next\":\n            {\n              if (focusIntent === \"prev\") {\n                elements.reverse();\n              }\n              var currentIdx = elements.indexOf(currentTarget);\n              elements = loop.value ? utils.reorderArray(elements, currentIdx + 1) : elements.slice(currentIdx + 1);\n              break;\n            }\n        }\n        vue.nextTick(function () {\n          utils.focusFirst(elements);\n        });\n      }\n    });\n    var isCurrentTab = vue.computed(function () {\n      return currentTabbedId.value === vue.unref(id);\n    });\n    vue.provide(tokens.ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY, {\n      rovingFocusGroupItemRef: rovingFocusGroupItemRef,\n      tabIndex: vue.computed(function () {\n        return vue.unref(isCurrentTab) ? 0 : -1;\n      }),\n      handleMousedown: handleMousedown,\n      handleFocus: handleFocus,\n      handleKeydown: handleKeydown\n    });\n    return {\n      id: id,\n      handleKeydown: handleKeydown,\n      handleFocus: handleFocus,\n      handleMousedown: handleMousedown\n    };\n  }\n});\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_roving_focus_collection_item = vue.resolveComponent(\"el-roving-focus-collection-item\");\n  return vue.openBlock(), vue.createBlock(_component_el_roving_focus_collection_item, {\n    id: _ctx.id,\n    focusable: _ctx.focusable,\n    active: _ctx.active\n  }, {\n    \"default\": vue.withCtx(function () {\n      return [vue.renderSlot(_ctx.$slots, \"default\")];\n    }),\n    _: 3\n  }, 8, [\"id\", \"focusable\", \"active\"]);\n}\nvar ElRovingFocusItem = /* @__PURE__ */pluginVue_exportHelper[\"default\"](_sfc_main, [[\"render\", _sfc_render], [\"__file\", \"roving-focus-item.vue\"]]);\nexports[\"default\"] = ElRovingFocusItem;","map":{"version":3,"names":["_sfc_main","vue","defineComponent","components","ElRovingFocusCollectionItem","rovingFocusGroup","ElCollectionItem","props","focusable","type","Boolean","active","emits","setup","_ref","emit","_vue$inject","inject","tokens","ROVING_FOCUS_GROUP_INJECTION_KEY","currentTabbedId","loop","onItemFocus","onItemShiftTab","_vue$inject2","ROVING_FOCUS_COLLECTION_INJECTION_KEY","getItems","id","index","useId","rovingFocusGroupItemRef","ref","handleMousedown","event","composeEventHandlers","e","preventDefault","unref","handleFocus","handleKeydown","code","shiftKey","target","currentTarget","aria","EVENT_CODE","tab","focusIntent","utils","getFocusIntent","items","filter","item","elements","map","reverse","currentIdx","indexOf","value","reorderArray","slice","nextTick","focusFirst","isCurrentTab","computed","provide","ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY","tabIndex","_sfc_render","_ctx","_cache","$props","$setup","$data","$options","_component_el_roving_focus_collection_item","resolveComponent","openBlock","createBlock","withCtx","renderSlot","$slots","_","ElRovingFocusItem","pluginVue_exportHelper"],"sources":["../../../../../../packages/components/roving-focus-group/src/roving-focus-item.vue"],"sourcesContent":["<template>\n  <el-roving-focus-collection-item\n    :id=\"id\"\n    :focusable=\"focusable\"\n    :active=\"active\"\n  >\n    <slot />\n  </el-roving-focus-collection-item>\n</template>\n\n<script lang=\"ts\">\nimport {\n  computed,\n  defineComponent,\n  inject,\n  nextTick,\n  provide,\n  ref,\n  unref,\n} from 'vue'\nimport { useId } from '@element-plus/hooks'\nimport { composeEventHandlers } from '@element-plus/utils'\nimport { EVENT_CODE } from '@element-plus/constants'\nimport {\n  ElCollectionItem as ElRovingFocusCollectionItem,\n  ROVING_FOCUS_COLLECTION_INJECTION_KEY,\n} from './roving-focus-group'\nimport {\n  ROVING_FOCUS_GROUP_INJECTION_KEY,\n  ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY,\n} from './tokens'\nimport { focusFirst, getFocusIntent, reorderArray } from './utils'\n\nexport default defineComponent({\n  components: {\n    ElRovingFocusCollectionItem,\n  },\n  props: {\n    focusable: {\n      type: Boolean,\n      default: true,\n    },\n    active: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  emits: ['mousedown', 'focus', 'keydown'],\n  setup(props, { emit }) {\n    const { currentTabbedId, loop, onItemFocus, onItemShiftTab } = inject(\n      ROVING_FOCUS_GROUP_INJECTION_KEY,\n      undefined\n    )!\n\n    const { getItems } = inject(\n      ROVING_FOCUS_COLLECTION_INJECTION_KEY,\n      undefined\n    )!\n\n    const id = useId()\n    const rovingFocusGroupItemRef = ref<HTMLElement>()\n\n    const handleMousedown = composeEventHandlers(\n      (e: Event) => {\n        emit('mousedown', e)\n      },\n      (e) => {\n        if (!props.focusable) {\n          e.preventDefault()\n        } else {\n          onItemFocus(unref(id))\n        }\n      }\n    )\n\n    const handleFocus = composeEventHandlers(\n      (e: Event) => {\n        emit('focus', e)\n      },\n      () => {\n        onItemFocus(unref(id))\n      }\n    )\n\n    const handleKeydown = composeEventHandlers(\n      (e: Event) => {\n        emit('keydown', e)\n      },\n      (e) => {\n        const { code, shiftKey, target, currentTarget } = e as KeyboardEvent\n        if (code === EVENT_CODE.tab && shiftKey) {\n          onItemShiftTab()\n          return\n        }\n        if (target !== currentTarget) return\n        const focusIntent = getFocusIntent(e as KeyboardEvent)\n\n        if (focusIntent) {\n          e.preventDefault()\n          const items = getItems<typeof props>().filter(\n            (item) => item.focusable\n          )\n\n          let elements = items.map((item) => item.ref!)\n\n          switch (focusIntent) {\n            case 'last': {\n              elements.reverse()\n              break\n            }\n            case 'prev':\n            case 'next': {\n              if (focusIntent === 'prev') {\n                elements.reverse()\n              }\n              const currentIdx = elements.indexOf(currentTarget as HTMLElement)\n              elements = loop.value\n                ? reorderArray(elements, currentIdx + 1)\n                : elements.slice(currentIdx + 1)\n              break\n            }\n            default: {\n              break\n            }\n          }\n\n          nextTick(() => {\n            focusFirst(elements)\n          })\n        }\n      }\n    )\n\n    const isCurrentTab = computed(() => currentTabbedId.value === unref(id))\n\n    provide(ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY, {\n      rovingFocusGroupItemRef,\n      tabIndex: computed(() => (unref(isCurrentTab) ? 0 : -1)),\n      handleMousedown,\n      handleFocus,\n      handleKeydown,\n    })\n\n    return {\n      id,\n      handleKeydown,\n      handleFocus,\n      handleMousedown,\n    }\n  },\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}