{"ast":null,"code":"'use strict';\n\nvar _objectSpread = require(\"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/objectSpread2.js\")[\"default\"];\nrequire(\"core-js/modules/es.error.to-string.js\");\nrequire(\"core-js/modules/es.date.to-string.js\");\nrequire(\"core-js/modules/es.number.parse-int.js\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nrequire(\"core-js/modules/es.regexp.to-string.js\");\nrequire(\"core-js/modules/web.timers.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar useGlobalConfig = require('../../config-provider/src/hooks/use-global-config.js');\nvar style = require('../../../utils/dom/style.js');\nfunction createLoadingComponent(options, appContext) {\n  var afterLeaveTimer;\n  var afterLeaveFlag = vue.ref(false);\n  var data = vue.reactive(_objectSpread(_objectSpread({}, options), {}, {\n    originalPosition: \"\",\n    originalOverflow: \"\",\n    visible: false\n  }));\n  function setText(text) {\n    data.text = text;\n  }\n  function destroySelf() {\n    var target = data.parent;\n    var ns = vm.ns;\n    if (!target.vLoadingAddClassList) {\n      var loadingNumber = target.getAttribute(\"loading-number\");\n      loadingNumber = Number.parseInt(loadingNumber) - 1;\n      if (!loadingNumber) {\n        style.removeClass(target, ns.bm(\"parent\", \"relative\"));\n        target.removeAttribute(\"loading-number\");\n      } else {\n        target.setAttribute(\"loading-number\", loadingNumber.toString());\n      }\n      style.removeClass(target, ns.bm(\"parent\", \"hidden\"));\n    }\n    removeElLoadingChild();\n    loadingInstance.unmount();\n  }\n  function removeElLoadingChild() {\n    var _a, _b;\n    (_b = (_a = vm.$el) == null ? void 0 : _a.parentNode) == null ? void 0 : _b.removeChild(vm.$el);\n  }\n  function close() {\n    var _a;\n    if (options.beforeClose && !options.beforeClose()) return;\n    afterLeaveFlag.value = true;\n    clearTimeout(afterLeaveTimer);\n    afterLeaveTimer = setTimeout(handleAfterLeave, 400);\n    data.visible = false;\n    (_a = options.closed) == null ? void 0 : _a.call(options);\n  }\n  function handleAfterLeave() {\n    if (!afterLeaveFlag.value) return;\n    var target = data.parent;\n    afterLeaveFlag.value = false;\n    target.vLoadingAddClassList = void 0;\n    destroySelf();\n  }\n  var elLoadingComponent = vue.defineComponent({\n    name: \"ElLoading\",\n    setup: function setup(_, _ref) {\n      var expose = _ref.expose;\n      var _useGlobalConfig$useG = useGlobalConfig.useGlobalComponentSettings(\"loading\"),\n        ns = _useGlobalConfig$useG.ns,\n        zIndex = _useGlobalConfig$useG.zIndex;\n      expose({\n        ns: ns,\n        zIndex: zIndex\n      });\n      return function () {\n        var svg = data.spinner || data.svg;\n        var spinner = vue.h(\"svg\", _objectSpread({\n          \"class\": \"circular\",\n          viewBox: data.svgViewBox ? data.svgViewBox : \"0 0 50 50\"\n        }, svg ? {\n          innerHTML: svg\n        } : {}), [vue.h(\"circle\", {\n          \"class\": \"path\",\n          cx: \"25\",\n          cy: \"25\",\n          r: \"20\",\n          fill: \"none\"\n        })]);\n        var spinnerText = data.text ? vue.h(\"p\", {\n          \"class\": ns.b(\"text\")\n        }, [data.text]) : void 0;\n        return vue.h(vue.Transition, {\n          name: ns.b(\"fade\"),\n          onAfterLeave: handleAfterLeave\n        }, {\n          \"default\": vue.withCtx(function () {\n            return [vue.withDirectives(vue.createVNode(\"div\", {\n              style: {\n                backgroundColor: data.background || \"\"\n              },\n              \"class\": [ns.b(\"mask\"), data.customClass, data.fullscreen ? \"is-fullscreen\" : \"\"]\n            }, [vue.h(\"div\", {\n              \"class\": ns.b(\"spinner\")\n            }, [spinner, spinnerText])]), [[vue.vShow, data.visible]])];\n          })\n        });\n      };\n    }\n  });\n  var loadingInstance = vue.createApp(elLoadingComponent);\n  Object.assign(loadingInstance._context, appContext != null ? appContext : {});\n  var vm = loadingInstance.mount(document.createElement(\"div\"));\n  return _objectSpread(_objectSpread({}, vue.toRefs(data)), {}, {\n    setText: setText,\n    removeElLoadingChild: removeElLoadingChild,\n    close: close,\n    handleAfterLeave: handleAfterLeave,\n    vm: vm,\n    get $el() {\n      return vm.$el;\n    }\n  });\n}\nexports.createLoadingComponent = createLoadingComponent;","map":{"version":3,"names":["createLoadingComponent","options","appContext","afterLeaveTimer","afterLeaveFlag","vue","ref","data","reactive","_objectSpread","originalPosition","originalOverflow","visible","setText","text","destroySelf","target","parent","ns","vm","vLoadingAddClassList","loadingNumber","getAttribute","Number","parseInt","style","removeClass","bm","removeAttribute","setAttribute","toString","removeElLoadingChild","loadingInstance","unmount","_a","_b","$el","parentNode","removeChild","close","beforeClose","value","clearTimeout","setTimeout","handleAfterLeave","closed","call","elLoadingComponent","defineComponent","name","setup","_","_ref","expose","_useGlobalConfig$useG","useGlobalConfig","useGlobalComponentSettings","zIndex","svg","spinner","h","viewBox","svgViewBox","innerHTML","cx","cy","r","fill","spinnerText","b","Transition","onAfterLeave","withCtx","withDirectives","createVNode","backgroundColor","background","customClass","fullscreen","vShow","createApp","Object","assign","_context","mount","document","createElement","toRefs"],"sources":["../../../../../../packages/components/loading/src/loading.ts"],"sourcesContent":["import {\n  Transition,\n  createApp,\n  createVNode,\n  defineComponent,\n  h,\n  reactive,\n  ref,\n  toRefs,\n  vShow,\n  withCtx,\n  withDirectives,\n} from 'vue'\nimport { removeClass } from '@element-plus/utils'\nimport { useGlobalComponentSettings } from '@element-plus/components/config-provider'\n\nimport type { AppContext } from 'vue'\nimport type { UseNamespaceReturn } from '@element-plus/hooks'\nimport type { LoadingOptionsResolved } from './types'\n\nexport function createLoadingComponent(\n  options: LoadingOptionsResolved,\n  appContext: AppContext | null\n) {\n  let afterLeaveTimer: ReturnType<typeof setTimeout>\n  // IMPORTANT NOTE: this is only a hacking way to expose the injections on an\n  // instance, DO NOT FOLLOW this pattern in your own code.\n  const afterLeaveFlag = ref(false)\n  const data = reactive({\n    ...options,\n    originalPosition: '',\n    originalOverflow: '',\n    visible: false,\n  })\n\n  function setText(text: string) {\n    data.text = text\n  }\n\n  function destroySelf() {\n    const target = data.parent\n    const ns = (vm as any).ns as UseNamespaceReturn\n    if (!target.vLoadingAddClassList) {\n      let loadingNumber: number | string | null =\n        target.getAttribute('loading-number')\n      loadingNumber = Number.parseInt(loadingNumber as any) - 1\n      if (!loadingNumber) {\n        removeClass(target, ns.bm('parent', 'relative'))\n        target.removeAttribute('loading-number')\n      } else {\n        target.setAttribute('loading-number', loadingNumber.toString())\n      }\n      removeClass(target, ns.bm('parent', 'hidden'))\n    }\n    removeElLoadingChild()\n    loadingInstance.unmount()\n  }\n  function removeElLoadingChild(): void {\n    vm.$el?.parentNode?.removeChild(vm.$el)\n  }\n  function close() {\n    if (options.beforeClose && !options.beforeClose()) return\n\n    afterLeaveFlag.value = true\n    clearTimeout(afterLeaveTimer)\n\n    afterLeaveTimer = setTimeout(handleAfterLeave, 400)\n    data.visible = false\n\n    options.closed?.()\n  }\n\n  function handleAfterLeave() {\n    if (!afterLeaveFlag.value) return\n    const target = data.parent\n    afterLeaveFlag.value = false\n    target.vLoadingAddClassList = undefined\n    destroySelf()\n  }\n\n  const elLoadingComponent = defineComponent({\n    name: 'ElLoading',\n    setup(_, { expose }) {\n      const { ns, zIndex } = useGlobalComponentSettings('loading')\n\n      expose({\n        ns,\n        zIndex,\n      })\n\n      return () => {\n        const svg = data.spinner || data.svg\n        const spinner = h(\n          'svg',\n          {\n            class: 'circular',\n            viewBox: data.svgViewBox ? data.svgViewBox : '0 0 50 50',\n            ...(svg ? { innerHTML: svg } : {}),\n          },\n          [\n            h('circle', {\n              class: 'path',\n              cx: '25',\n              cy: '25',\n              r: '20',\n              fill: 'none',\n            }),\n          ]\n        )\n\n        const spinnerText = data.text\n          ? h('p', { class: ns.b('text') }, [data.text])\n          : undefined\n\n        return h(\n          Transition,\n          {\n            name: ns.b('fade'),\n            onAfterLeave: handleAfterLeave,\n          },\n          {\n            default: withCtx(() => [\n              withDirectives(\n                createVNode(\n                  'div',\n                  {\n                    style: {\n                      backgroundColor: data.background || '',\n                    },\n                    class: [\n                      ns.b('mask'),\n                      data.customClass,\n                      data.fullscreen ? 'is-fullscreen' : '',\n                    ],\n                  },\n                  [\n                    h(\n                      'div',\n                      {\n                        class: ns.b('spinner'),\n                      },\n                      [spinner, spinnerText]\n                    ),\n                  ]\n                ),\n                [[vShow, data.visible]]\n              ),\n            ]),\n          }\n        )\n      }\n    },\n  })\n\n  const loadingInstance = createApp(elLoadingComponent)\n  Object.assign(loadingInstance._context, appContext ?? {})\n  const vm = loadingInstance.mount(document.createElement('div'))\n\n  return {\n    ...toRefs(data),\n    setText,\n    removeElLoadingChild,\n    close,\n    handleAfterLeave,\n    vm,\n    get $el(): HTMLElement {\n      return vm.$el\n    },\n  }\n}\n\nexport type LoadingInstance = ReturnType<typeof createLoadingComponent>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}