{"ast":null,"code":"'use strict';\n\nvar _objectSpread = require(\"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/objectSpread2.js\")[\"default\"];\nrequire(\"core-js/modules/es.array.for-each.js\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar lodashUnified = require('lodash-unified');\nvar focusTrap = require('../../focus-trap/src/focus-trap.js');\nvar constants$1 = require('./constants.js');\nvar content = require('./content.js');\nvar pluginVue_exportHelper = require('../../../_virtual/plugin-vue_export-helper.js');\nvar useFocusTrap = require('./composables/use-focus-trap.js');\nvar useContent = require('./composables/use-content.js');\nvar useContentDom = require('./composables/use-content-dom.js');\nvar constants = require('../../form/src/constants.js');\nvar shared = require('@vue/shared');\nvar types = require('../../../utils/types.js');\nvar __default__ = vue.defineComponent({\n  name: \"ElPopperContent\"\n});\nvar _sfc_main = /* @__PURE__ */vue.defineComponent(_objectSpread(_objectSpread({}, __default__), {}, {\n  props: content.popperContentProps,\n  emits: content.popperContentEmits,\n  setup: function setup(__props, _ref) {\n    var expose = _ref.expose,\n      emit = _ref.emit;\n    var props = __props;\n    var _useFocusTrap$usePopp = useFocusTrap.usePopperContentFocusTrap(props, emit),\n      focusStartRef = _useFocusTrap$usePopp.focusStartRef,\n      trapped = _useFocusTrap$usePopp.trapped,\n      onFocusAfterReleased = _useFocusTrap$usePopp.onFocusAfterReleased,\n      onFocusAfterTrapped = _useFocusTrap$usePopp.onFocusAfterTrapped,\n      onFocusInTrap = _useFocusTrap$usePopp.onFocusInTrap,\n      onFocusoutPrevented = _useFocusTrap$usePopp.onFocusoutPrevented,\n      onReleaseRequested = _useFocusTrap$usePopp.onReleaseRequested;\n    var _useContent$usePopper = useContent.usePopperContent(props),\n      attributes = _useContent$usePopper.attributes,\n      arrowRef = _useContent$usePopper.arrowRef,\n      contentRef = _useContent$usePopper.contentRef,\n      styles = _useContent$usePopper.styles,\n      instanceRef = _useContent$usePopper.instanceRef,\n      role = _useContent$usePopper.role,\n      update = _useContent$usePopper.update;\n    var _useContentDom$usePop = useContentDom.usePopperContentDOM(props, {\n        styles: styles,\n        attributes: attributes,\n        role: role\n      }),\n      ariaModal = _useContentDom$usePop.ariaModal,\n      arrowStyle = _useContentDom$usePop.arrowStyle,\n      contentAttrs = _useContentDom$usePop.contentAttrs,\n      contentClass = _useContentDom$usePop.contentClass,\n      contentStyle = _useContentDom$usePop.contentStyle,\n      updateZIndex = _useContentDom$usePop.updateZIndex;\n    var formItemContext = vue.inject(constants.formItemContextKey, void 0);\n    vue.provide(constants$1.POPPER_CONTENT_INJECTION_KEY, {\n      arrowStyle: arrowStyle,\n      arrowRef: arrowRef\n    });\n    if (formItemContext) {\n      vue.provide(constants.formItemContextKey, _objectSpread(_objectSpread({}, formItemContext), {}, {\n        addInputId: shared.NOOP,\n        removeInputId: shared.NOOP\n      }));\n    }\n    var triggerTargetAriaStopWatch = void 0;\n    var updatePopper = function updatePopper() {\n      var shouldUpdateZIndex = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      update();\n      shouldUpdateZIndex && updateZIndex();\n    };\n    var togglePopperAlive = function togglePopperAlive() {\n      updatePopper(false);\n      if (props.visible && props.focusOnShow) {\n        trapped.value = true;\n      } else if (props.visible === false) {\n        trapped.value = false;\n      }\n    };\n    vue.onMounted(function () {\n      vue.watch(function () {\n        return props.triggerTargetEl;\n      }, function (triggerTargetEl, prevTriggerTargetEl) {\n        triggerTargetAriaStopWatch == null ? void 0 : triggerTargetAriaStopWatch();\n        triggerTargetAriaStopWatch = void 0;\n        var el = vue.unref(triggerTargetEl || contentRef.value);\n        var prevEl = vue.unref(prevTriggerTargetEl || contentRef.value);\n        if (types.isElement(el)) {\n          triggerTargetAriaStopWatch = vue.watch([role, function () {\n            return props.ariaLabel;\n          }, ariaModal, function () {\n            return props.id;\n          }], function (watches) {\n            [\"role\", \"aria-label\", \"aria-modal\", \"id\"].forEach(function (key, idx) {\n              lodashUnified.isNil(watches[idx]) ? el.removeAttribute(key) : el.setAttribute(key, watches[idx]);\n            });\n          }, {\n            immediate: true\n          });\n        }\n        if (prevEl !== el && types.isElement(prevEl)) {\n          [\"role\", \"aria-label\", \"aria-modal\", \"id\"].forEach(function (key) {\n            prevEl.removeAttribute(key);\n          });\n        }\n      }, {\n        immediate: true\n      });\n      vue.watch(function () {\n        return props.visible;\n      }, togglePopperAlive, {\n        immediate: true\n      });\n    });\n    vue.onBeforeUnmount(function () {\n      triggerTargetAriaStopWatch == null ? void 0 : triggerTargetAriaStopWatch();\n      triggerTargetAriaStopWatch = void 0;\n    });\n    expose({\n      popperContentRef: contentRef,\n      popperInstanceRef: instanceRef,\n      updatePopper: updatePopper,\n      contentStyle: contentStyle\n    });\n    return function (_ctx, _cache) {\n      return vue.openBlock(), vue.createElementBlock(\"div\", vue.mergeProps({\n        ref_key: \"contentRef\",\n        ref: contentRef\n      }, vue.unref(contentAttrs), {\n        style: vue.unref(contentStyle),\n        \"class\": vue.unref(contentClass),\n        tabindex: \"-1\",\n        onMouseenter: function onMouseenter(e) {\n          return _ctx.$emit(\"mouseenter\", e);\n        },\n        onMouseleave: function onMouseleave(e) {\n          return _ctx.$emit(\"mouseleave\", e);\n        }\n      }), [vue.createVNode(vue.unref(focusTrap[\"default\"]), {\n        trapped: vue.unref(trapped),\n        \"trap-on-focus-in\": true,\n        \"focus-trap-el\": vue.unref(contentRef),\n        \"focus-start-el\": vue.unref(focusStartRef),\n        onFocusAfterTrapped: vue.unref(onFocusAfterTrapped),\n        onFocusAfterReleased: vue.unref(onFocusAfterReleased),\n        onFocusin: vue.unref(onFocusInTrap),\n        onFocusoutPrevented: vue.unref(onFocusoutPrevented),\n        onReleaseRequested: vue.unref(onReleaseRequested)\n      }, {\n        \"default\": vue.withCtx(function () {\n          return [vue.renderSlot(_ctx.$slots, \"default\")];\n        }),\n        _: 3\n      }, 8, [\"trapped\", \"focus-trap-el\", \"focus-start-el\", \"onFocusAfterTrapped\", \"onFocusAfterReleased\", \"onFocusin\", \"onFocusoutPrevented\", \"onReleaseRequested\"])], 16, [\"onMouseenter\", \"onMouseleave\"]);\n    };\n  }\n}));\nvar ElPopperContent = /* @__PURE__ */pluginVue_exportHelper[\"default\"](_sfc_main, [[\"__file\", \"content.vue\"]]);\nexports[\"default\"] = ElPopperContent;","map":{"version":3,"names":["name","_useFocusTrap$usePopp","useFocusTrap","usePopperContentFocusTrap","props","emit","focusStartRef","trapped","onFocusAfterReleased","onFocusAfterTrapped","onFocusInTrap","onFocusoutPrevented","onReleaseRequested","_useContent$usePopper","useContent","usePopperContent","attributes","arrowRef","contentRef","styles","instanceRef","role","update","_useContentDom$usePop","useContentDom","usePopperContentDOM","ariaModal","arrowStyle","contentAttrs","contentClass","contentStyle","updateZIndex","formItemContext","vue","inject","constants","formItemContextKey","provide","constants$1","POPPER_CONTENT_INJECTION_KEY","_objectSpread","addInputId","shared","NOOP","removeInputId","triggerTargetAriaStopWatch","updatePopper","shouldUpdateZIndex","arguments","length","undefined","togglePopperAlive","visible","focusOnShow","value","onMounted","watch","triggerTargetEl","prevTriggerTargetEl","el","unref","prevEl","types","isElement","ariaLabel","id","watches","forEach","key","idx","lodashUnified","isNil","removeAttribute","setAttribute","immediate","onBeforeUnmount","expose","popperContentRef","popperInstanceRef","_ctx","_cache","openBlock","createElementBlock","mergeProps","ref_key","ref","style","tabindex","onMouseenter","e","$emit","onMouseleave","createVNode","focusTrap","onFocusin"],"sources":["../../../../../../packages/components/popper/src/content.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"contentRef\"\n    v-bind=\"contentAttrs\"\n    :style=\"contentStyle\"\n    :class=\"contentClass\"\n    tabindex=\"-1\"\n    @mouseenter=\"(e) => $emit('mouseenter', e)\"\n    @mouseleave=\"(e) => $emit('mouseleave', e)\"\n  >\n    <el-focus-trap\n      :trapped=\"trapped\"\n      :trap-on-focus-in=\"true\"\n      :focus-trap-el=\"contentRef\"\n      :focus-start-el=\"focusStartRef\"\n      @focus-after-trapped=\"onFocusAfterTrapped\"\n      @focus-after-released=\"onFocusAfterReleased\"\n      @focusin=\"onFocusInTrap\"\n      @focusout-prevented=\"onFocusoutPrevented\"\n      @release-requested=\"onReleaseRequested\"\n    >\n      <slot />\n    </el-focus-trap>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { inject, onBeforeUnmount, onMounted, provide, unref, watch } from 'vue'\nimport { isNil } from 'lodash-unified'\nimport { NOOP, isElement } from '@element-plus/utils'\nimport ElFocusTrap from '@element-plus/components/focus-trap'\nimport { formItemContextKey } from '@element-plus/components/form'\nimport { POPPER_CONTENT_INJECTION_KEY } from './constants'\nimport { popperContentEmits, popperContentProps } from './content'\nimport {\n  usePopperContent,\n  usePopperContentDOM,\n  usePopperContentFocusTrap,\n} from './composables'\n\nimport type { WatchStopHandle } from 'vue'\n\ndefineOptions({\n  name: 'ElPopperContent',\n})\n\nconst emit = defineEmits(popperContentEmits)\n\nconst props = defineProps(popperContentProps)\n\nconst {\n  focusStartRef,\n  trapped,\n\n  onFocusAfterReleased,\n  onFocusAfterTrapped,\n  onFocusInTrap,\n  onFocusoutPrevented,\n  onReleaseRequested,\n} = usePopperContentFocusTrap(props, emit)\n\nconst { attributes, arrowRef, contentRef, styles, instanceRef, role, update } =\n  usePopperContent(props)\n\nconst {\n  ariaModal,\n  arrowStyle,\n  contentAttrs,\n  contentClass,\n  contentStyle,\n  updateZIndex,\n} = usePopperContentDOM(props, {\n  styles,\n  attributes,\n  role,\n})\n\nconst formItemContext = inject(formItemContextKey, undefined)\n\nprovide(POPPER_CONTENT_INJECTION_KEY, {\n  arrowStyle,\n  arrowRef,\n})\n\nif (formItemContext) {\n  // disallow auto-id from inside popper content\n  provide(formItemContextKey, {\n    ...formItemContext,\n    addInputId: NOOP,\n    removeInputId: NOOP,\n  })\n}\n\nlet triggerTargetAriaStopWatch: WatchStopHandle | undefined = undefined\n\nconst updatePopper = (shouldUpdateZIndex = true) => {\n  update()\n  shouldUpdateZIndex && updateZIndex()\n}\n\nconst togglePopperAlive = () => {\n  updatePopper(false)\n  if (props.visible && props.focusOnShow) {\n    trapped.value = true\n  } else if (props.visible === false) {\n    trapped.value = false\n  }\n}\n\nonMounted(() => {\n  watch(\n    () => props.triggerTargetEl,\n    (triggerTargetEl, prevTriggerTargetEl) => {\n      triggerTargetAriaStopWatch?.()\n      triggerTargetAriaStopWatch = undefined\n\n      const el = unref(triggerTargetEl || contentRef.value)\n      const prevEl = unref(prevTriggerTargetEl || contentRef.value)\n\n      if (isElement(el)) {\n        triggerTargetAriaStopWatch = watch(\n          [role, () => props.ariaLabel, ariaModal, () => props.id],\n          (watches) => {\n            ;['role', 'aria-label', 'aria-modal', 'id'].forEach((key, idx) => {\n              isNil(watches[idx])\n                ? el.removeAttribute(key)\n                : el.setAttribute(key, watches[idx]!)\n            })\n          },\n          { immediate: true }\n        )\n      }\n      if (prevEl !== el && isElement(prevEl)) {\n        ;['role', 'aria-label', 'aria-modal', 'id'].forEach((key) => {\n          prevEl.removeAttribute(key)\n        })\n      }\n    },\n    { immediate: true }\n  )\n\n  watch(() => props.visible, togglePopperAlive, { immediate: true })\n})\n\nonBeforeUnmount(() => {\n  triggerTargetAriaStopWatch?.()\n  triggerTargetAriaStopWatch = undefined\n})\n\ndefineExpose({\n  /**\n   * @description popper content element\n   */\n  popperContentRef: contentRef,\n  /**\n   * @description popperjs instance\n   */\n  popperInstanceRef: instanceRef,\n  /**\n   * @description method for updating popper\n   */\n  updatePopper,\n\n  /**\n   * @description content style\n   */\n  contentStyle,\n})\n</script>\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;qCA0Cc;EACZA,IAAM;AACR;;;;;;;;IAMM,IAAAC,qBAAA,GASFC,YAAA,CAAAC,yBAA0B,CAAAC,KAAA,EAAOC,IAAI;MARvCC,aAAA,GAAAL,qBAAA,CAAAK,aAAA;MACAC,OAAA,GAAAN,qBAAA,CAAAM,OAAA;MAEAC,oBAAA,GAAAP,qBAAA,CAAAO,oBAAA;MACAC,mBAAA,GAAAR,qBAAA,CAAAQ,mBAAA;MACAC,aAAA,GAAAT,qBAAA,CAAAS,aAAA;MACAC,mBAAA,GAAAV,qBAAA,CAAAU,mBAAA;MACAC,kBAAA,GAAAX,qBAAA,CAAAW,kBAAA;IAGI,IAAAC,qBAAA,GACJC,UAAA,CAAAC,gBAAA,CAAiBX,KAAK;MADhBY,UAAY,GAAAH,qBAAA,CAAZG,UAAY;MAAAC,QAAA,GAAAJ,qBAAA,CAAAI,QAAA;MAAUC,UAAY,GAAAL,qBAAA,CAAZK,UAAY;MAAAC,MAAA,GAAAN,qBAAA,CAAAM,MAAA;MAAQC,WAAA,GAAAP,qBAAA,CAAAO,WAAA;MAAaC,IAAM,GAAAR,qBAAA,CAANQ,IAAM;MAAAC,MAAA,GAAAT,qBAAA,CAAAS,MAAA;IAG/D,IAAAC,qBAAA,GAOFC,aAAA,CAAAC,mBAAA,CAAoBrB,KAAO;QAC7Be,MAAA,EAAAA,MAAA;QACAH,UAAA,EAAAA,UAAA;QACAK,IAAA,EAAAA;MAAA,CACD;MAVCK,SAAA,GAAAH,qBAAA,CAAAG,SAAA;MACAC,UAAA,GAAAJ,qBAAA,CAAAI,UAAA;MACAC,YAAA,GAAAL,qBAAA,CAAAK,YAAA;MACAC,YAAA,GAAAN,qBAAA,CAAAM,YAAA;MACAC,YAAA,GAAAP,qBAAA,CAAAO,YAAA;MACAC,YAAA,GAAAR,qBAAA,CAAAQ,YAAA;IAOI,IAAAC,eAAA,GAAkBC,GAAA,CAAAC,MAAO,CAAAC,SAAA,CAAAC,kBAAA,EAAoB,KAAS;IAE5DH,GAAA,CAAAI,OAAA,CAAQC,WAAA,CAAAC,4BAA8B;MACpCZ,UAAA,EAAAA,UAAA;MACAV,QAAA,EAAAA;IAAA,CACD;IAED,IAAIe,eAAiB;MAEnBC,GAAA,CAAAI,OAAA,CAAQF,SAAA,CAAAC,kBAAoB,EAAAI,aAAA,CAAAA,aAAA,KACvBR,eAAA;QACHS,UAAY,EAAAC,MAAA,CAAAC,IAAA;QACZC,aAAe,EAAAF,MAAA,CAAAC;MAAA,EAChB;IAAA;IAGH,IAAIE,0BAA0D;IAExD,IAAAC,YAAA,GAAe,SAAfA,aAAA,EAA8C;MAAA,IAA9BC,kBAAA,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAqB,IAAS;MAC3C1B,MAAA;MACPyB,kBAAA,IAAsBhB,YAAa;IAAA,CACrC;IAEA,IAAMoB,iBAAA,GAAoB,SAApBA,kBAAA,EAA0B;MAC9BL,YAAA,CAAa,KAAK;MACd,IAAA1C,KAAA,CAAMgD,OAAW,IAAAhD,KAAA,CAAMiD,WAAa;QACtC9C,OAAA,CAAQ+C,KAAQ;MAAA,CAClB,UAAWlD,KAAM,CAAAgD,OAAA,KAAY,KAAO;QAClC7C,OAAA,CAAQ+C,KAAQ;MAAA;IAClB,CACF;IAEArB,GAAA,CAAAsB,SAAA,CAAU,YAAM;MACdtB,GAAA,CAAAuB,KAAA;QAAA,OAAApD,KAAA,CAAAqD,eAAA;MAAA,aAAAA,eAAA,EAAAC,mBAAA;QACEb,0BAAY,oBAAAA,0BAAA;QACZA,0BAA0C;QACX,IAAAc,EAAA,GAAA1B,GAAA,CAAA2B,KAAA,CAAAH,eAAA,IAAAvC,UAAA,CAAAoC,KAAA;QACA,IAAAO,MAAA,GAAA5B,GAAA,CAAA2B,KAAA,CAAAF,mBAAA,IAAAxC,UAAA,CAAAoC,KAAA;QAE7B,IAAAQ,KAAA,CAAAC,SAAW,CAAAJ,EAAA,GAAM;UACjBd,0BAA4C,GAAAZ,GAAA,CAAAuB,KAAA,EAAAnC,IAAA;YAAA,OAAAjB,KAAA,CAAA4D,SAAgB;UAAA,GAAAtC,SAAA;YAAA,OAAAtB,KAAA,CAAA6D,EAAA;UAAA,cAAAC,OAAA;YAG7B,2CAAAC,OAAA,WAAAC,GAAA,EAAAC,GAAA;cAC3BC,aAAA,CAAAC,KAAA,CAAAL,OAAa,CAAAG,GAAA,EAAM,GAAAV,EAAA,CAAAa,eAAsB,CAAAJ,GAAA,IAAAT,EAAA,CAAAc,YAAc,CAAAL,GAAA,EAAAF,OAAA,CAAAG,GAAA;YAAA,EACvD;UACE;YAAAK,SAAA;UAAA;QAAC;QACC,IAAAb,MAAA,KAAAF,EAAc,IAAAG,KAAA,CAAAC,SAAI,CAAAF,MACX;UAGX,2CAAAM,OAAA,WAAAC,GAAA;YACAP,MAAA,CAAAW,eAAkB,CAAAJ,GAAA;UAAA,CACpB;QAAA;MAEF;QAAAM,SAAe;MAAA;MACbzC,GAAA,CAAAuB,KAAA;QAAA,OAAApD,KAAA,CAAAgD,OAAA;MAAA,GAAAD,iBAAA;QAAAuB,SAAA;MAAA;IAAC;IACCzC,GAAA,CAAA0C,eAAA;MAA0B9B,0BAC3B,oBAAAA,0BAAA;MACHA,0BAAA;IAAA,CACF;IACA+B,MAAE;MACJC,gBAAA,EAAA3D,UAAA;MAEA4D,iBAAkB,EAAA1D,WAAA;MACnB0B,YAAA,EAAAA,YAAA;MAEDhB,YAAA,EAAAA;IACE,CAA6B;IACA,iBAAAiD,IAAA,EAAAC,MAAA;MAC9B,OAAA/C,GAAA,CAAAgD,SAAA,IAAAhD,GAAA,CAAAiD,kBAAA,QAAAjD,GAAA,CAAAkD,UAAA;QAEYC,OAAA;QAAAC,GAAA,EAAAnE;MAAA,GAAAe,GAAA,CAAA2B,KAAA,CAAAhC,YAAA;QAAA0D,KAAA,EAAArD,GAAA,CAAA2B,KAAA,CAAA9B,YAAA;QAIO,SAAAG,GAAA,CAAA2B,KAAA,CAAA/B,YAAA;QAAA0D,QAAA;QAAAC,YAAA,WAAAA,aAAAC,CAAA;UAAA,OAAAV,IAAA,CAAAW,KAAA,eAAAD,CAAA;QAAA;QAAAE,YAAA,WAAAA,aAAAF,CAAA;UAAA,OAAAV,IAAA,CAAAW,KAAA,eAAAD,CAAA;QAAA;MAAA,CAIC,IAAAxD,GAAA,CAAA2D,WAAA,CAAA3D,GAAA,CAAA2B,KAAA,CAAAiC,SAAA;QAAAtF,OAAA,EAAA0B,GAAA,CAAA2B,KAAA,CAAArD,OAAA;QAAA;QAInB,iBAAA0B,GAAA,CAAA2B,KAAA,CAAA1C,UAAA;QAAA,kBAAAe,GAAA,CAAA2B,KAAA,CAAAtD,aAAA;QAAAG,mBAAA,EAAAwB,GAAA,CAAA2B,KAAA,CAAAnD,mBAAA;QAAAD,oBAAA,EAAAyB,GAAA,CAAA2B,KAAA,CAAApD,oBAAA;QAKAsF,SAAA,EAAA7D,GAAA,CAAA2B,KAAA,CAAAlD,aAAA;QACDC,mBAAA,EAAAsB,GAAA,CAAA2B,KAAA,CAAAjD,mBAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}