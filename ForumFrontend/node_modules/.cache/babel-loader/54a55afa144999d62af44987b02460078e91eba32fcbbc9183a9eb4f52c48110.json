{"ast":null,"code":"'use strict';\n\nvar _objectSpread = require(\"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/objectSpread2.js\")[\"default\"];\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar lodashUnified = require('lodash-unified');\nvar constants = require('../constants.js');\nvar utils = require('../utils.js');\nvar index = require('../../../../hooks/use-popper/index.js');\nvar DEFAULT_ARROW_OFFSET = 0;\nvar usePopperContent = function usePopperContent(props) {\n  var _vue$inject = vue.inject(constants.POPPER_INJECTION_KEY, void 0),\n    popperInstanceRef = _vue$inject.popperInstanceRef,\n    contentRef = _vue$inject.contentRef,\n    triggerRef = _vue$inject.triggerRef,\n    role = _vue$inject.role;\n  var arrowRef = vue.ref();\n  var arrowOffset = vue.computed(function () {\n    return props.arrowOffset;\n  });\n  var eventListenerModifier = vue.computed(function () {\n    return {\n      name: \"eventListeners\",\n      enabled: !!props.visible\n    };\n  });\n  var arrowModifier = vue.computed(function () {\n    var _a;\n    var arrowEl = vue.unref(arrowRef);\n    var offset = (_a = vue.unref(arrowOffset)) != null ? _a : DEFAULT_ARROW_OFFSET;\n    return {\n      name: \"arrow\",\n      enabled: !lodashUnified.isUndefined(arrowEl),\n      options: {\n        element: arrowEl,\n        padding: offset\n      }\n    };\n  });\n  var options = vue.computed(function () {\n    return _objectSpread({\n      onFirstUpdate: function onFirstUpdate() {\n        update();\n      }\n    }, utils.buildPopperOptions(props, [vue.unref(arrowModifier), vue.unref(eventListenerModifier)]));\n  });\n  var computedReference = vue.computed(function () {\n    return utils.unwrapMeasurableEl(props.referenceEl) || vue.unref(triggerRef);\n  });\n  var _index$usePopper = index.usePopper(computedReference, contentRef, options),\n    attributes = _index$usePopper.attributes,\n    state = _index$usePopper.state,\n    styles = _index$usePopper.styles,\n    update = _index$usePopper.update,\n    forceUpdate = _index$usePopper.forceUpdate,\n    instanceRef = _index$usePopper.instanceRef;\n  vue.watch(instanceRef, function (instance) {\n    return popperInstanceRef.value = instance;\n  }, {\n    flush: \"sync\"\n  });\n  vue.onMounted(function () {\n    vue.watch(function () {\n      var _a;\n      return (_a = vue.unref(computedReference)) == null ? void 0 : _a.getBoundingClientRect();\n    }, function () {\n      update();\n    });\n  });\n  return {\n    attributes: attributes,\n    arrowRef: arrowRef,\n    contentRef: contentRef,\n    instanceRef: instanceRef,\n    state: state,\n    styles: styles,\n    role: role,\n    forceUpdate: forceUpdate,\n    update: update\n  };\n};\nexports.usePopperContent = usePopperContent;","map":{"version":3,"names":["DEFAULT_ARROW_OFFSET","usePopperContent","props","_vue$inject","vue","inject","constants","POPPER_INJECTION_KEY","popperInstanceRef","contentRef","triggerRef","role","arrowRef","ref","arrowOffset","computed","eventListenerModifier","name","enabled","visible","arrowModifier","_a","arrowEl","unref","offset","lodashUnified","isUndefined","options","element","padding","_objectSpread","onFirstUpdate","update","utils","buildPopperOptions","computedReference","unwrapMeasurableEl","referenceEl","_index$usePopper","index","usePopper","attributes","state","styles","forceUpdate","instanceRef","watch","instance","value","flush","onMounted","getBoundingClientRect"],"sources":["../../../../../../../packages/components/popper/src/composables/use-content.ts"],"sourcesContent":["import { computed, inject, onMounted, ref, unref, watch } from 'vue'\nimport { isUndefined } from 'lodash-unified'\nimport { usePopper } from '@element-plus/hooks'\nimport { POPPER_INJECTION_KEY } from '../constants'\nimport { buildPopperOptions, unwrapMeasurableEl } from '../utils'\n\nimport type { Modifier } from '@popperjs/core'\nimport type { PartialOptions } from '@element-plus/hooks'\nimport type { PopperContentProps } from '../content'\n\nconst DEFAULT_ARROW_OFFSET = 0\n\nexport const usePopperContent = (props: PopperContentProps) => {\n  const { popperInstanceRef, contentRef, triggerRef, role } = inject(\n    POPPER_INJECTION_KEY,\n    undefined\n  )!\n\n  const arrowRef = ref<HTMLElement>()\n  const arrowOffset = computed(() => props.arrowOffset)\n\n  const eventListenerModifier = computed(() => {\n    return {\n      name: 'eventListeners',\n      enabled: !!props.visible,\n    } as Modifier<'eventListeners', any>\n  })\n\n  const arrowModifier = computed(() => {\n    const arrowEl = unref(arrowRef)\n    const offset = unref(arrowOffset) ?? DEFAULT_ARROW_OFFSET\n    // Seems like the `phase` and `fn` is required by Modifier type\n    // But on its documentation they didn't specify that.\n    // Refer to https://popper.js.org/docs/v2/modifiers/arrow/\n    return {\n      name: 'arrow',\n      enabled: !isUndefined(arrowEl),\n      options: {\n        element: arrowEl,\n        padding: offset,\n      },\n    } as any\n  })\n\n  const options = computed<PartialOptions>(() => {\n    return {\n      onFirstUpdate: () => {\n        update()\n      },\n      ...buildPopperOptions(props, [\n        unref(arrowModifier),\n        unref(eventListenerModifier),\n      ]),\n    }\n  })\n\n  const computedReference = computed(\n    () => unwrapMeasurableEl(props.referenceEl) || unref(triggerRef)\n  )\n\n  const { attributes, state, styles, update, forceUpdate, instanceRef } =\n    usePopper(computedReference, contentRef, options)\n\n  watch(instanceRef, (instance) => (popperInstanceRef.value = instance), {\n    flush: 'sync',\n  })\n\n  onMounted(() => {\n    watch(\n      () => unref(computedReference)?.getBoundingClientRect(),\n      () => {\n        update()\n      }\n    )\n  })\n\n  return {\n    attributes,\n    arrowRef,\n    contentRef,\n    instanceRef,\n    state,\n    styles,\n    role,\n\n    forceUpdate,\n    update,\n  }\n}\n\nexport type UsePopperContentReturn = ReturnType<typeof usePopperContent>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}