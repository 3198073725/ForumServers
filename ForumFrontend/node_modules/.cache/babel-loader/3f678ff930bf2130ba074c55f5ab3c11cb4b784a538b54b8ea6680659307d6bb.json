{"ast":null,"code":"import _objectSpread from \"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _regeneratorRuntime from \"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport { computed, onMounted, toRefs, reactive } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { useStore } from 'vuex';\nimport { ElMessage } from 'element-plus';\nimport { formatDateTime } from '@/utils/index';\nimport { getUserProfile, getUserById, updateUserProfile, getUserPosts, getUserComments, getUserFavorites, changePassword } from '@/api/profile';\n\n// 格式化日期函数\nvar formatDate = function formatDate(date) {\n  return formatDateTime(date);\n};\nexport default {\n  name: 'UserProfile',\n  setup: function setup() {\n    var route = useRoute();\n    var router = useRouter();\n    var store = useStore();\n\n    // 状态\n    var state = reactive({\n      loading: false,\n      userProfile: {},\n      userStats: {\n        posts_count: 0,\n        comments_count: 0,\n        favorites_count: 0\n      },\n      activeTab: 'posts',\n      // 帖子相关\n      postsLoading: false,\n      posts: [],\n      postsTotal: 0,\n      postsQuery: {\n        page: 1,\n        limit: 10\n      },\n      // 评论相关\n      commentsLoading: false,\n      comments: [],\n      commentsTotal: 0,\n      commentsQuery: {\n        page: 1,\n        limit: 10\n      },\n      // 收藏相关\n      favoritesLoading: false,\n      favorites: [],\n      favoritesTotal: 0,\n      favoritesQuery: {\n        page: 1,\n        limit: 10\n      },\n      // 编辑资料相关\n      editProfileDialogVisible: false,\n      profileForm: {\n        nickname: '',\n        avatar_url: ''\n      },\n      profileRules: {\n        nickname: [{\n          max: 50,\n          message: '昵称不能超过50个字符',\n          trigger: 'blur'\n        }]\n      },\n      // 修改密码相关\n      changePasswordDialogVisible: false,\n      passwordForm: {\n        old_password: '',\n        new_password: '',\n        confirm_password: ''\n      },\n      passwordRules: {\n        old_password: [{\n          required: true,\n          message: '请输入当前密码',\n          trigger: 'blur'\n        }],\n        new_password: [{\n          required: true,\n          message: '请输入新密码',\n          trigger: 'blur'\n        }, {\n          min: 6,\n          message: '密码长度不能少于6个字符',\n          trigger: 'blur'\n        }],\n        confirm_password: [{\n          required: true,\n          message: '请再次输入新密码',\n          trigger: 'blur'\n        }, {\n          validator: function validator(rule, value, callback) {\n            if (value !== state.passwordForm.new_password) {\n              callback(new Error('两次输入的密码不一致'));\n            } else {\n              callback();\n            }\n          },\n          trigger: 'blur'\n        }]\n      },\n      submitting: false\n    });\n\n    // 计算属性\n    var userId = computed(function () {\n      return route.params.id || 'me';\n    });\n    var isCurrentUser = computed(function () {\n      return !route.params.id || route.params.id === 'me' || route.params.id === store.getters.userId.toString();\n    });\n\n    // 从查询参数中获取激活的标签页\n    if (route.query.tab && ['posts', 'comments', 'favorites'].includes(route.query.tab)) {\n      state.activeTab = route.query.tab;\n    }\n\n    // 获取用户信息\n    var fetchUserProfile = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var token, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              state.loading = true;\n              _context.prev = 1;\n              // 检查本地存储的token\n              token = localStorage.getItem('token');\n              console.log('获取用户信息前的token:', token);\n              if (!(userId.value === 'me' || !userId.value)) {\n                _context.next = 11;\n                break;\n              }\n              console.log('获取当前用户信息');\n              _context.next = 8;\n              return getUserProfile();\n            case 8:\n              response = _context.sent;\n              _context.next = 15;\n              break;\n            case 11:\n              console.log('获取指定用户信息:', userId.value);\n              _context.next = 14;\n              return getUserById(userId.value);\n            case 14:\n              response = _context.sent;\n            case 15:\n              console.log('用户信息响应:', response);\n\n              // 处理不同的响应格式\n              if (!(response.code === 0)) {\n                _context.next = 20;\n                break;\n              }\n              state.userProfile = response.data;\n              _context.next = 27;\n              break;\n            case 20:\n              if (!response.id) {\n                _context.next = 24;\n                break;\n              }\n              // 直接返回了用户对象\n              state.userProfile = response;\n              _context.next = 27;\n              break;\n            case 24:\n              ElMessage.error('获取用户信息失败: 响应格式不正确');\n              console.error('响应格式不正确:', response);\n              return _context.abrupt(\"return\");\n            case 27:\n              // 初始化编辑表单\n              state.profileForm.nickname = state.userProfile.nickname;\n              state.profileForm.avatar_url = state.userProfile.avatar_url;\n              _context.next = 35;\n              break;\n            case 31:\n              _context.prev = 31;\n              _context.t0 = _context[\"catch\"](1);\n              console.error('获取用户信息失败:', _context.t0);\n              ElMessage.error('获取用户信息失败');\n            case 35:\n              _context.prev = 35;\n              state.loading = false;\n              return _context.finish(35);\n            case 38:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[1, 31, 35, 38]]);\n      }));\n      return function fetchUserProfile() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    // 获取用户帖子\n    var fetchUserPosts = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              state.postsLoading = true;\n              _context2.prev = 1;\n              _context2.next = 4;\n              return getUserPosts(userId.value);\n            case 4:\n              response = _context2.sent;\n              if (response.code === 0) {\n                state.posts = response.data.results || [];\n                state.postsTotal = response.data.count || 0;\n                state.userStats.posts_count = response.data.count || 0;\n              } else {\n                ElMessage.error(response.msg || '获取用户帖子失败');\n              }\n              _context2.next = 12;\n              break;\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](1);\n              console.error('获取用户帖子失败:', _context2.t0);\n              ElMessage.error('获取用户帖子失败');\n            case 12:\n              _context2.prev = 12;\n              state.postsLoading = false;\n              return _context2.finish(12);\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[1, 8, 12, 15]]);\n      }));\n      return function fetchUserPosts() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    // 获取用户评论\n    var fetchUserComments = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              state.commentsLoading = true;\n              _context3.prev = 1;\n              _context3.next = 4;\n              return getUserComments(userId.value);\n            case 4:\n              response = _context3.sent;\n              if (response.code === 0) {\n                state.comments = response.data.results || [];\n                state.commentsTotal = response.data.count || 0;\n                state.userStats.comments_count = response.data.count || 0;\n              } else {\n                ElMessage.error(response.msg || '获取用户评论失败');\n              }\n              _context3.next = 12;\n              break;\n            case 8:\n              _context3.prev = 8;\n              _context3.t0 = _context3[\"catch\"](1);\n              console.error('获取用户评论失败:', _context3.t0);\n              ElMessage.error('获取用户评论失败');\n            case 12:\n              _context3.prev = 12;\n              state.commentsLoading = false;\n              return _context3.finish(12);\n            case 15:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, null, [[1, 8, 12, 15]]);\n      }));\n      return function fetchUserComments() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    // 获取用户收藏\n    var fetchUserFavorites = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              state.favoritesLoading = true;\n              _context4.prev = 1;\n              _context4.next = 4;\n              return getUserFavorites(userId.value);\n            case 4:\n              response = _context4.sent;\n              if (response.code === 0) {\n                state.favorites = response.data.results || [];\n                state.favoritesTotal = response.data.count || 0;\n                state.userStats.favorites_count = response.data.count || 0;\n              } else {\n                ElMessage.error(response.msg || '获取用户收藏失败');\n              }\n              _context4.next = 12;\n              break;\n            case 8:\n              _context4.prev = 8;\n              _context4.t0 = _context4[\"catch\"](1);\n              console.error('获取用户收藏失败:', _context4.t0);\n              ElMessage.error('获取用户收藏失败');\n            case 12:\n              _context4.prev = 12;\n              state.favoritesLoading = false;\n              return _context4.finish(12);\n            case 15:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, null, [[1, 8, 12, 15]]);\n      }));\n      return function fetchUserFavorites() {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    // 处理标签页切换\n    var handleTabClick = function handleTabClick(tab) {\n      state.activeTab = tab.name;\n      if (tab.name === 'posts' && state.posts.length === 0) {\n        fetchUserPosts();\n      } else if (tab.name === 'comments' && state.comments.length === 0) {\n        fetchUserComments();\n      } else if (tab.name === 'favorites' && state.favorites.length === 0) {\n        fetchUserFavorites();\n      }\n    };\n\n    // 处理帖子分页变化\n    var handlePostsPageChange = function handlePostsPageChange(page) {\n      state.postsQuery.page = page;\n      fetchUserPosts();\n    };\n\n    // 处理评论分页变化\n    var handleCommentsPageChange = function handleCommentsPageChange(page) {\n      state.commentsQuery.page = page;\n      fetchUserComments();\n    };\n\n    // 处理收藏分页变化\n    var handleFavoritesPageChange = function handleFavoritesPageChange(page) {\n      state.favoritesQuery.page = page;\n      fetchUserFavorites();\n    };\n\n    // 查看帖子\n    var viewPost = function viewPost(post) {\n      router.push({\n        name: 'PostDetail',\n        params: {\n          id: post.id\n        }\n      });\n    };\n\n    // 显示编辑资料对话框\n    var showEditProfileDialog = function showEditProfileDialog() {\n      state.editProfileDialogVisible = true;\n    };\n\n    // 提交编辑资料表单\n    var submitProfileForm = /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              state.submitting = true;\n              _context5.prev = 1;\n              _context5.next = 4;\n              return updateUserProfile(state.profileForm);\n            case 4:\n              response = _context5.sent;\n              if (response.code === 0) {\n                ElMessage.success(response.msg || '个人资料更新成功');\n                state.editProfileDialogVisible = false;\n\n                // 更新用户信息\n                fetchUserProfile();\n\n                // 更新Vuex中的用户信息\n                store.dispatch('updateUserInfo', _objectSpread(_objectSpread({}, store.getters.userInfo), {}, {\n                  nickname: state.profileForm.nickname,\n                  avatar_url: state.profileForm.avatar_url\n                }));\n              } else {\n                ElMessage.error(response.msg || '个人资料更新失败');\n              }\n              _context5.next = 12;\n              break;\n            case 8:\n              _context5.prev = 8;\n              _context5.t0 = _context5[\"catch\"](1);\n              console.error('个人资料更新失败:', _context5.t0);\n              ElMessage.error('个人资料更新失败');\n            case 12:\n              _context5.prev = 12;\n              state.submitting = false;\n              return _context5.finish(12);\n            case 15:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, null, [[1, 8, 12, 15]]);\n      }));\n      return function submitProfileForm() {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n\n    // 显示修改密码对话框\n    var showChangePasswordDialog = function showChangePasswordDialog() {\n      state.changePasswordDialogVisible = true;\n      state.passwordForm = {\n        old_password: '',\n        new_password: '',\n        confirm_password: ''\n      };\n    };\n\n    // 提交修改密码表单\n    var submitPasswordForm = /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              state.submitting = true;\n              _context6.prev = 1;\n              _context6.next = 4;\n              return changePassword(state.passwordForm);\n            case 4:\n              response = _context6.sent;\n              if (response.code === 0) {\n                ElMessage.success(response.msg || '密码修改成功，请重新登录');\n                state.changePasswordDialogVisible = false;\n\n                // 退出登录\n                store.dispatch('logout');\n                router.push('/login');\n              } else {\n                ElMessage.error(response.msg || '密码修改失败');\n              }\n              _context6.next = 12;\n              break;\n            case 8:\n              _context6.prev = 8;\n              _context6.t0 = _context6[\"catch\"](1);\n              console.error('密码修改失败:', _context6.t0);\n              ElMessage.error('密码修改失败');\n            case 12:\n              _context6.prev = 12;\n              state.submitting = false;\n              return _context6.finish(12);\n            case 15:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, null, [[1, 8, 12, 15]]);\n      }));\n      return function submitPasswordForm() {\n        return _ref6.apply(this, arguments);\n      };\n    }();\n\n    // 生命周期钩子\n    onMounted(function () {\n      fetchUserProfile();\n      fetchUserPosts();\n    });\n    return _objectSpread(_objectSpread({}, toRefs(state)), {}, {\n      userId: userId,\n      isCurrentUser: isCurrentUser,\n      formatDate: formatDate,\n      handleTabClick: handleTabClick,\n      handlePostsPageChange: handlePostsPageChange,\n      handleCommentsPageChange: handleCommentsPageChange,\n      handleFavoritesPageChange: handleFavoritesPageChange,\n      viewPost: viewPost,\n      showEditProfileDialog: showEditProfileDialog,\n      submitProfileForm: submitProfileForm,\n      showChangePasswordDialog: showChangePasswordDialog,\n      submitPasswordForm: submitPasswordForm\n    });\n  }\n};","map":{"version":3,"names":["computed","onMounted","toRefs","reactive","useRoute","useRouter","useStore","ElMessage","formatDateTime","getUserProfile","getUserById","updateUserProfile","getUserPosts","getUserComments","getUserFavorites","changePassword","formatDate","date","name","setup","route","router","store","state","loading","userProfile","userStats","posts_count","comments_count","favorites_count","activeTab","postsLoading","posts","postsTotal","postsQuery","page","limit","commentsLoading","comments","commentsTotal","commentsQuery","favoritesLoading","favorites","favoritesTotal","favoritesQuery","editProfileDialogVisible","profileForm","nickname","avatar_url","profileRules","max","message","trigger","changePasswordDialogVisible","passwordForm","old_password","new_password","confirm_password","passwordRules","required","min","validator","rule","value","callback","Error","submitting","userId","params","id","isCurrentUser","getters","toString","query","tab","includes","fetchUserProfile","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","token","response","wrap","_callee$","_context","prev","next","localStorage","getItem","console","log","sent","code","data","error","abrupt","t0","finish","stop","apply","arguments","fetchUserPosts","_ref2","_callee2","_callee2$","_context2","results","count","msg","fetchUserComments","_ref3","_callee3","_callee3$","_context3","fetchUserFavorites","_ref4","_callee4","_callee4$","_context4","handleTabClick","length","handlePostsPageChange","handleCommentsPageChange","handleFavoritesPageChange","viewPost","post","push","showEditProfileDialog","submitProfileForm","_ref5","_callee5","_callee5$","_context5","success","dispatch","_objectSpread","userInfo","showChangePasswordDialog","submitPasswordForm","_ref6","_callee6","_callee6$","_context6"],"sources":["H:\\ForumServers\\ForumFrontend\\src\\views\\user\\Profile.vue"],"sourcesContent":["<template>\n  <div class=\"profile-container\">\n    <el-row :gutter=\"20\">\n      <!-- 左侧用户信息卡片 -->\n      <el-col :span=\"6\">\n        <el-card class=\"profile-card\">\n          <div v-if=\"loading\" class=\"loading-container\">\n            <el-skeleton :rows=\"5\" animated />\n          </div>\n          <div v-else class=\"user-info\">\n            <div class=\"avatar-container\">\n              <el-avatar :size=\"100\" :src=\"userProfile.avatar_url || ''\">\n                {{ userProfile.nickname?.charAt(0) || userProfile.username?.charAt(0) || 'U' }}\n              </el-avatar>\n            </div>\n            <h2 class=\"username\">{{ userProfile.nickname || userProfile.username }}</h2>\n            <div class=\"user-meta\">\n              <div class=\"meta-item\">\n                <i class=\"el-icon-user\"></i>\n                <span>{{ userProfile.username }}</span>\n              </div>\n              <div class=\"meta-item\">\n                <i class=\"el-icon-message\"></i>\n                <span>{{ userProfile.email }}</span>\n              </div>\n              <div class=\"meta-item\">\n                <i class=\"el-icon-date\"></i>\n                <span>注册于 {{ formatDate(userProfile.created_at) }}</span>\n              </div>\n              <div class=\"meta-item\">\n                <i class=\"el-icon-time\"></i>\n                <span>最后登录 {{ formatDate(userProfile.last_login) }}</span>\n              </div>\n            </div>\n\n            <div class=\"user-stats\">\n              <div class=\"stat-item\">\n                <div class=\"stat-value\">{{ userStats.posts_count || 0 }}</div>\n                <div class=\"stat-label\">帖子</div>\n              </div>\n              <div class=\"stat-item\">\n                <div class=\"stat-value\">{{ userStats.comments_count || 0 }}</div>\n                <div class=\"stat-label\">评论</div>\n              </div>\n              <div class=\"stat-item\">\n                <div class=\"stat-value\">{{ userStats.favorites_count || 0 }}</div>\n                <div class=\"stat-label\">收藏</div>\n              </div>\n            </div>\n\n            <div v-if=\"isCurrentUser\" class=\"user-actions\">\n              <el-button type=\"primary\" @click=\"showEditProfileDialog\">编辑资料</el-button>\n              <el-button @click=\"showChangePasswordDialog\">修改密码</el-button>\n            </div>\n          </div>\n        </el-card>\n      </el-col>\n\n      <!-- 右侧内容区域 -->\n      <el-col :span=\"18\">\n        <el-card class=\"content-card\">\n          <el-tabs v-model=\"activeTab\" @tab-click=\"handleTabClick\">\n            <el-tab-pane label=\"我的帖子\" name=\"posts\">\n              <div v-if=\"postsLoading\" class=\"loading-container\">\n                <el-skeleton :rows=\"5\" animated />\n              </div>\n              <div v-else-if=\"posts.length === 0\" class=\"empty-container\">\n                <el-empty description=\"暂无帖子\" />\n              </div>\n              <div v-else class=\"post-list\">\n                <div\n                  v-for=\"post in posts\"\n                  :key=\"post.id\"\n                  class=\"post-item\"\n                  @click=\"viewPost(post)\"\n                >\n                  <div class=\"post-title\">\n                    <el-tag v-if=\"post.is_pinned\" size=\"mini\" type=\"danger\">置顶</el-tag>\n                    <el-tag v-if=\"post.is_featured\" size=\"mini\" type=\"success\">精华</el-tag>\n                    <span>{{ post.title }}</span>\n                  </div>\n                  <div class=\"post-meta\">\n                    <div class=\"post-board\">\n                      <i class=\"el-icon-s-grid\"></i>\n                      <span>{{ post.board_name }}</span>\n                    </div>\n                    <div class=\"post-stats\">\n                      <span><i class=\"el-icon-view\"></i> {{ post.views }}</span>\n                      <span><i class=\"el-icon-star-on\"></i> {{ post.likes_count }}</span>\n                      <span><i class=\"el-icon-chat-dot-round\"></i> {{ post.comments_count }}</span>\n                    </div>\n                    <div class=\"post-time\">{{ formatDate(post.created_at) }}</div>\n                  </div>\n                </div>\n\n                <!-- 分页 -->\n                <div v-if=\"posts.length > 0\" class=\"pagination-container\">\n                  <el-pagination\n                    background\n                    layout=\"prev, pager, next\"\n                    :total=\"postsTotal\"\n                    :page-size=\"postsQuery.limit\"\n                    v-model:current-page=\"postsQuery.page\"\n                    @current-change=\"handlePostsPageChange\"\n                  >\n                  </el-pagination>\n                </div>\n              </div>\n            </el-tab-pane>\n\n            <el-tab-pane label=\"我的评论\" name=\"comments\">\n              <div v-if=\"commentsLoading\" class=\"loading-container\">\n                <el-skeleton :rows=\"5\" animated />\n              </div>\n              <div v-else-if=\"comments.length === 0\" class=\"empty-container\">\n                <el-empty description=\"暂无评论\" />\n              </div>\n              <div v-else class=\"comment-list\">\n                <div\n                  v-for=\"comment in comments\"\n                  :key=\"comment.id\"\n                  class=\"comment-item\"\n                >\n                  <div class=\"comment-content\">{{ comment.content }}</div>\n                  <div class=\"comment-meta\">\n                    <div class=\"comment-post\" @click=\"viewPost({ id: comment.post })\">\n                      <i class=\"el-icon-document\"></i>\n                      <span>查看原帖</span>\n                    </div>\n                    <div class=\"comment-time\">{{ formatDate(comment.created_at) }}</div>\n                  </div>\n                </div>\n\n                <!-- 分页 -->\n                <div v-if=\"comments.length > 0\" class=\"pagination-container\">\n                  <el-pagination\n                    background\n                    layout=\"prev, pager, next\"\n                    :total=\"commentsTotal\"\n                    :page-size=\"commentsQuery.limit\"\n                    v-model:current-page=\"commentsQuery.page\"\n                    @current-change=\"handleCommentsPageChange\"\n                  >\n                  </el-pagination>\n                </div>\n              </div>\n            </el-tab-pane>\n\n            <el-tab-pane label=\"我的收藏\" name=\"favorites\">\n              <div v-if=\"favoritesLoading\" class=\"loading-container\">\n                <el-skeleton :rows=\"5\" animated />\n              </div>\n              <div v-else-if=\"favorites.length === 0\" class=\"empty-container\">\n                <el-empty description=\"暂无收藏\" />\n              </div>\n              <div v-else class=\"favorite-list\">\n                <div\n                  v-for=\"favorite in favorites\"\n                  :key=\"favorite.id\"\n                  class=\"favorite-item\"\n                  @click=\"viewPost(favorite.post)\"\n                >\n                  <div class=\"post-title\">\n                    <el-tag v-if=\"favorite.post.is_pinned\" size=\"mini\" type=\"danger\">置顶</el-tag>\n                    <el-tag v-if=\"favorite.post.is_featured\" size=\"mini\" type=\"success\">精华</el-tag>\n                    <span>{{ favorite.post.title }}</span>\n                  </div>\n                  <div class=\"post-meta\">\n                    <div class=\"post-author\">\n                      <i class=\"el-icon-user\"></i>\n                      <span>{{ favorite.post.user.nickname || favorite.post.user.username }}</span>\n                    </div>\n                    <div class=\"post-board\">\n                      <i class=\"el-icon-s-grid\"></i>\n                      <span>{{ favorite.post.board_name }}</span>\n                    </div>\n                    <div class=\"post-stats\">\n                      <span><i class=\"el-icon-view\"></i> {{ favorite.post.views }}</span>\n                      <span><i class=\"el-icon-star-on\"></i> {{ favorite.post.likes_count }}</span>\n                      <span><i class=\"el-icon-chat-dot-round\"></i> {{ favorite.post.comments_count }}</span>\n                    </div>\n                    <div class=\"post-time\">{{ formatDate(favorite.created_at) }}</div>\n                  </div>\n                </div>\n\n                <!-- 分页 -->\n                <div v-if=\"favorites.length > 0\" class=\"pagination-container\">\n                  <el-pagination\n                    background\n                    layout=\"prev, pager, next\"\n                    :total=\"favoritesTotal\"\n                    :page-size=\"favoritesQuery.limit\"\n                    v-model:current-page=\"favoritesQuery.page\"\n                    @current-change=\"handleFavoritesPageChange\"\n                  >\n                  </el-pagination>\n                </div>\n              </div>\n            </el-tab-pane>\n          </el-tabs>\n        </el-card>\n      </el-col>\n    </el-row>\n\n    <!-- 编辑资料对话框 -->\n    <el-dialog\n      title=\"编辑个人资料\"\n      v-model:visible=\"editProfileDialogVisible\"\n      width=\"500px\"\n    >\n      <el-form\n        ref=\"profileForm\"\n        :model=\"profileForm\"\n        :rules=\"profileRules\"\n        label-width=\"80px\"\n      >\n        <el-form-item label=\"昵称\" prop=\"nickname\">\n          <el-input v-model=\"profileForm.nickname\" placeholder=\"请输入昵称\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"头像\">\n          <el-input v-model=\"profileForm.avatar_url\" placeholder=\"请输入头像URL\"></el-input>\n          <div class=\"avatar-preview\">\n            <el-avatar :size=\"60\" :src=\"profileForm.avatar_url || ''\">\n              {{ profileForm.nickname?.charAt(0) || userProfile.username?.charAt(0) || 'U' }}\n            </el-avatar>\n          </div>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"editProfileDialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"submitProfileForm\" :loading=\"submitting\">确 定</el-button>\n      </span>\n    </el-dialog>\n\n    <!-- 修改密码对话框 -->\n    <el-dialog\n      title=\"修改密码\"\n      v-model:visible=\"changePasswordDialogVisible\"\n      width=\"500px\"\n    >\n      <el-form\n        ref=\"passwordForm\"\n        :model=\"passwordForm\"\n        :rules=\"passwordRules\"\n        label-width=\"100px\"\n      >\n        <el-form-item label=\"当前密码\" prop=\"old_password\">\n          <el-input\n            v-model=\"passwordForm.old_password\"\n            type=\"password\"\n            placeholder=\"请输入当前密码\"\n            show-password\n          ></el-input>\n        </el-form-item>\n        <el-form-item label=\"新密码\" prop=\"new_password\">\n          <el-input\n            v-model=\"passwordForm.new_password\"\n            type=\"password\"\n            placeholder=\"请输入新密码\"\n            show-password\n          ></el-input>\n        </el-form-item>\n        <el-form-item label=\"确认新密码\" prop=\"confirm_password\">\n          <el-input\n            v-model=\"passwordForm.confirm_password\"\n            type=\"password\"\n            placeholder=\"请再次输入新密码\"\n            show-password\n          ></el-input>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"changePasswordDialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"submitPasswordForm\" :loading=\"submitting\">确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { computed, onMounted, toRefs, reactive } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { useStore } from 'vuex'\nimport { ElMessage } from 'element-plus'\nimport { formatDateTime } from '@/utils/index'\nimport {\n  getUserProfile,\n  getUserById,\n  updateUserProfile,\n  getUserPosts,\n  getUserComments,\n  getUserFavorites,\n  changePassword\n} from '@/api/profile'\n\n// 格式化日期函数\nconst formatDate = (date) => {\n  return formatDateTime(date)\n}\n\nexport default {\n  name: 'UserProfile',\n  setup() {\n    const route = useRoute()\n    const router = useRouter()\n    const store = useStore()\n\n    // 状态\n    const state = reactive({\n      loading: false,\n      userProfile: {},\n      userStats: {\n        posts_count: 0,\n        comments_count: 0,\n        favorites_count: 0\n      },\n      activeTab: 'posts',\n\n      // 帖子相关\n      postsLoading: false,\n      posts: [],\n      postsTotal: 0,\n      postsQuery: {\n        page: 1,\n        limit: 10\n      },\n\n      // 评论相关\n      commentsLoading: false,\n      comments: [],\n      commentsTotal: 0,\n      commentsQuery: {\n        page: 1,\n        limit: 10\n      },\n\n      // 收藏相关\n      favoritesLoading: false,\n      favorites: [],\n      favoritesTotal: 0,\n      favoritesQuery: {\n        page: 1,\n        limit: 10\n      },\n\n      // 编辑资料相关\n      editProfileDialogVisible: false,\n      profileForm: {\n        nickname: '',\n        avatar_url: ''\n      },\n      profileRules: {\n        nickname: [\n          { max: 50, message: '昵称不能超过50个字符', trigger: 'blur' }\n        ]\n      },\n\n      // 修改密码相关\n      changePasswordDialogVisible: false,\n      passwordForm: {\n        old_password: '',\n        new_password: '',\n        confirm_password: ''\n      },\n      passwordRules: {\n        old_password: [\n          { required: true, message: '请输入当前密码', trigger: 'blur' }\n        ],\n        new_password: [\n          { required: true, message: '请输入新密码', trigger: 'blur' },\n          { min: 6, message: '密码长度不能少于6个字符', trigger: 'blur' }\n        ],\n        confirm_password: [\n          { required: true, message: '请再次输入新密码', trigger: 'blur' },\n          {\n            validator: (rule, value, callback) => {\n              if (value !== state.passwordForm.new_password) {\n                callback(new Error('两次输入的密码不一致'))\n              } else {\n                callback()\n              }\n            },\n            trigger: 'blur'\n          }\n        ]\n      },\n\n      submitting: false\n    })\n\n    // 计算属性\n    const userId = computed(() => route.params.id || 'me')\n    const isCurrentUser = computed(() => !route.params.id || route.params.id === 'me' || route.params.id === store.getters.userId.toString())\n\n    // 从查询参数中获取激活的标签页\n    if (route.query.tab && ['posts', 'comments', 'favorites'].includes(route.query.tab)) {\n      state.activeTab = route.query.tab\n    }\n\n    // 获取用户信息\n    const fetchUserProfile = async () => {\n      state.loading = true\n      try {\n        // 检查本地存储的token\n        const token = localStorage.getItem('token')\n        console.log('获取用户信息前的token:', token)\n\n        let response\n        if (userId.value === 'me' || !userId.value) {\n          console.log('获取当前用户信息')\n          response = await getUserProfile()\n        } else {\n          console.log('获取指定用户信息:', userId.value)\n          response = await getUserById(userId.value)\n        }\n\n        console.log('用户信息响应:', response)\n\n        // 处理不同的响应格式\n        if (response.code === 0) {\n          state.userProfile = response.data\n        } else if (response.id) {\n          // 直接返回了用户对象\n          state.userProfile = response\n        } else {\n          ElMessage.error('获取用户信息失败: 响应格式不正确')\n          console.error('响应格式不正确:', response)\n          return\n        }\n\n        // 初始化编辑表单\n        state.profileForm.nickname = state.userProfile.nickname\n        state.profileForm.avatar_url = state.userProfile.avatar_url\n      } catch (error) {\n        console.error('获取用户信息失败:', error)\n        ElMessage.error('获取用户信息失败')\n      } finally {\n        state.loading = false\n      }\n    }\n\n    // 获取用户帖子\n    const fetchUserPosts = async () => {\n      state.postsLoading = true\n      try {\n        const response = await getUserPosts(userId.value)\n        if (response.code === 0) {\n          state.posts = response.data.results || []\n          state.postsTotal = response.data.count || 0\n          state.userStats.posts_count = response.data.count || 0\n        } else {\n          ElMessage.error(response.msg || '获取用户帖子失败')\n        }\n      } catch (error) {\n        console.error('获取用户帖子失败:', error)\n        ElMessage.error('获取用户帖子失败')\n      } finally {\n        state.postsLoading = false\n      }\n    }\n\n    // 获取用户评论\n    const fetchUserComments = async () => {\n      state.commentsLoading = true\n      try {\n        const response = await getUserComments(userId.value)\n        if (response.code === 0) {\n          state.comments = response.data.results || []\n          state.commentsTotal = response.data.count || 0\n          state.userStats.comments_count = response.data.count || 0\n        } else {\n          ElMessage.error(response.msg || '获取用户评论失败')\n        }\n      } catch (error) {\n        console.error('获取用户评论失败:', error)\n        ElMessage.error('获取用户评论失败')\n      } finally {\n        state.commentsLoading = false\n      }\n    }\n\n    // 获取用户收藏\n    const fetchUserFavorites = async () => {\n      state.favoritesLoading = true\n      try {\n        const response = await getUserFavorites(userId.value)\n        if (response.code === 0) {\n          state.favorites = response.data.results || []\n          state.favoritesTotal = response.data.count || 0\n          state.userStats.favorites_count = response.data.count || 0\n        } else {\n          ElMessage.error(response.msg || '获取用户收藏失败')\n        }\n      } catch (error) {\n        console.error('获取用户收藏失败:', error)\n        ElMessage.error('获取用户收藏失败')\n      } finally {\n        state.favoritesLoading = false\n      }\n    }\n\n    // 处理标签页切换\n    const handleTabClick = (tab) => {\n      state.activeTab = tab.name\n\n      if (tab.name === 'posts' && state.posts.length === 0) {\n        fetchUserPosts()\n      } else if (tab.name === 'comments' && state.comments.length === 0) {\n        fetchUserComments()\n      } else if (tab.name === 'favorites' && state.favorites.length === 0) {\n        fetchUserFavorites()\n      }\n    }\n\n    // 处理帖子分页变化\n    const handlePostsPageChange = (page) => {\n      state.postsQuery.page = page\n      fetchUserPosts()\n    }\n\n    // 处理评论分页变化\n    const handleCommentsPageChange = (page) => {\n      state.commentsQuery.page = page\n      fetchUserComments()\n    }\n\n    // 处理收藏分页变化\n    const handleFavoritesPageChange = (page) => {\n      state.favoritesQuery.page = page\n      fetchUserFavorites()\n    }\n\n    // 查看帖子\n    const viewPost = (post) => {\n      router.push({ name: 'PostDetail', params: { id: post.id } })\n    }\n\n    // 显示编辑资料对话框\n    const showEditProfileDialog = () => {\n      state.editProfileDialogVisible = true\n    }\n\n    // 提交编辑资料表单\n    const submitProfileForm = async () => {\n      state.submitting = true\n      try {\n        const response = await updateUserProfile(state.profileForm)\n        if (response.code === 0) {\n          ElMessage.success(response.msg || '个人资料更新成功')\n          state.editProfileDialogVisible = false\n\n          // 更新用户信息\n          fetchUserProfile()\n\n          // 更新Vuex中的用户信息\n          store.dispatch('updateUserInfo', {\n            ...store.getters.userInfo,\n            nickname: state.profileForm.nickname,\n            avatar_url: state.profileForm.avatar_url\n          })\n        } else {\n          ElMessage.error(response.msg || '个人资料更新失败')\n        }\n      } catch (error) {\n        console.error('个人资料更新失败:', error)\n        ElMessage.error('个人资料更新失败')\n      } finally {\n        state.submitting = false\n      }\n    }\n\n    // 显示修改密码对话框\n    const showChangePasswordDialog = () => {\n      state.changePasswordDialogVisible = true\n      state.passwordForm = {\n        old_password: '',\n        new_password: '',\n        confirm_password: ''\n      }\n    }\n\n    // 提交修改密码表单\n    const submitPasswordForm = async () => {\n      state.submitting = true\n      try {\n        const response = await changePassword(state.passwordForm)\n        if (response.code === 0) {\n          ElMessage.success(response.msg || '密码修改成功，请重新登录')\n          state.changePasswordDialogVisible = false\n\n          // 退出登录\n          store.dispatch('logout')\n          router.push('/login')\n        } else {\n          ElMessage.error(response.msg || '密码修改失败')\n        }\n      } catch (error) {\n        console.error('密码修改失败:', error)\n        ElMessage.error('密码修改失败')\n      } finally {\n        state.submitting = false\n      }\n    }\n\n    // 生命周期钩子\n    onMounted(() => {\n      fetchUserProfile()\n      fetchUserPosts()\n    })\n\n    return {\n      ...toRefs(state),\n      userId,\n      isCurrentUser,\n      formatDate,\n      handleTabClick,\n      handlePostsPageChange,\n      handleCommentsPageChange,\n      handleFavoritesPageChange,\n      viewPost,\n      showEditProfileDialog,\n      submitProfileForm,\n      showChangePasswordDialog,\n      submitPasswordForm\n    }\n  }\n}\n</script>\n\n<style scoped>\n.profile-container {\n  padding: 20px;\n}\n\n.loading-container {\n  padding: 20px 0;\n}\n\n.profile-card,\n.content-card {\n  margin-bottom: 20px;\n}\n\n.user-info {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.avatar-container {\n  margin-bottom: 15px;\n}\n\n.username {\n  margin: 0 0 15px;\n  font-size: 20px;\n}\n\n.user-meta {\n  width: 100%;\n  margin-bottom: 20px;\n}\n\n.meta-item {\n  display: flex;\n  align-items: center;\n  margin-bottom: 8px;\n  color: #606266;\n}\n\n.meta-item i {\n  margin-right: 8px;\n  width: 16px;\n  text-align: center;\n}\n\n.user-stats {\n  display: flex;\n  justify-content: space-around;\n  width: 100%;\n  margin-bottom: 20px;\n  padding: 15px 0;\n  border-top: 1px solid #ebeef5;\n  border-bottom: 1px solid #ebeef5;\n}\n\n.stat-item {\n  text-align: center;\n}\n\n.stat-value {\n  font-size: 20px;\n  font-weight: bold;\n  color: #409eff;\n}\n\n.stat-label {\n  font-size: 14px;\n  color: #606266;\n}\n\n.user-actions {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  gap: 10px;\n}\n\n.empty-container {\n  padding: 40px 0;\n}\n\n.post-list,\n.comment-list,\n.favorite-list {\n  margin-bottom: 20px;\n}\n\n.post-item,\n.favorite-item {\n  padding: 15px;\n  border-bottom: 1px solid #ebeef5;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.post-item:hover,\n.favorite-item:hover {\n  background-color: #f5f7fa;\n}\n\n.post-item:last-child,\n.favorite-item:last-child {\n  border-bottom: none;\n}\n\n.post-title {\n  font-size: 16px;\n  font-weight: bold;\n  margin-bottom: 10px;\n  display: flex;\n  align-items: center;\n}\n\n.post-title .el-tag {\n  margin-right: 8px;\n}\n\n.post-meta {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 13px;\n  color: #909399;\n}\n\n.post-board,\n.post-author {\n  display: flex;\n  align-items: center;\n}\n\n.post-board i,\n.post-author i {\n  margin-right: 5px;\n}\n\n.post-stats {\n  display: flex;\n}\n\n.post-stats span {\n  margin-right: 15px;\n  display: flex;\n  align-items: center;\n}\n\n.post-stats span i {\n  margin-right: 5px;\n}\n\n.comment-item {\n  padding: 15px;\n  border-bottom: 1px solid #ebeef5;\n}\n\n.comment-item:last-child {\n  border-bottom: none;\n}\n\n.comment-content {\n  margin-bottom: 10px;\n  line-height: 1.5;\n  white-space: pre-wrap;\n}\n\n.comment-meta {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 13px;\n  color: #909399;\n}\n\n.comment-post {\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  color: #409eff;\n}\n\n.comment-post i {\n  margin-right: 5px;\n}\n\n.pagination-container {\n  text-align: center;\n  margin-top: 20px;\n}\n\n.avatar-preview {\n  margin-top: 10px;\n  display: flex;\n  justify-content: center;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}