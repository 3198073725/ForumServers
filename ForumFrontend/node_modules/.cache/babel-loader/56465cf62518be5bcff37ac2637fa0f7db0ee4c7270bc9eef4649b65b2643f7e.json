{"ast":null,"code":"'use strict';\n\nvar _objectSpread = require(\"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/objectSpread2.js\")[\"default\"];\nrequire(\"core-js/modules/es.array.filter.js\");\nrequire(\"core-js/modules/es.array.find.js\");\nrequire(\"core-js/modules/es.array.for-each.js\");\nrequire(\"core-js/modules/es.array.map.js\");\nrequire(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/es.array.reduce.js\");\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.filter.js\");\nrequire(\"core-js/modules/es.iterator.find.js\");\nrequire(\"core-js/modules/es.iterator.for-each.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nrequire(\"core-js/modules/es.iterator.reduce.js\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nrequire(\"core-js/modules/es.string.fixed.js\");\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar constants = require('../constants.js');\nvar _private = require('../private.js');\nvar utils = require('./utils.js');\nvar shared = require('@vue/shared');\nfunction useColumns(props, columns, fixed) {\n  var _columns = vue.computed(function () {\n    return vue.unref(columns).map(function (column, index) {\n      var _a, _b;\n      return _objectSpread(_objectSpread({}, column), {}, {\n        key: (_b = (_a = column.key) != null ? _a : column.dataKey) != null ? _b : index\n      });\n    });\n  });\n  var visibleColumns = vue.computed(function () {\n    return vue.unref(_columns).filter(function (column) {\n      return !column.hidden;\n    });\n  });\n  var fixedColumnsOnLeft = vue.computed(function () {\n    return vue.unref(visibleColumns).filter(function (column) {\n      return column.fixed === \"left\" || column.fixed === true;\n    });\n  });\n  var fixedColumnsOnRight = vue.computed(function () {\n    return vue.unref(visibleColumns).filter(function (column) {\n      return column.fixed === \"right\";\n    });\n  });\n  var normalColumns = vue.computed(function () {\n    return vue.unref(visibleColumns).filter(function (column) {\n      return !column.fixed;\n    });\n  });\n  var mainColumns = vue.computed(function () {\n    var ret = [];\n    vue.unref(fixedColumnsOnLeft).forEach(function (column) {\n      ret.push(_objectSpread(_objectSpread({}, column), {}, {\n        placeholderSign: _private.placeholderSign\n      }));\n    });\n    vue.unref(normalColumns).forEach(function (column) {\n      ret.push(column);\n    });\n    vue.unref(fixedColumnsOnRight).forEach(function (column) {\n      ret.push(_objectSpread(_objectSpread({}, column), {}, {\n        placeholderSign: _private.placeholderSign\n      }));\n    });\n    return ret;\n  });\n  var hasFixedColumns = vue.computed(function () {\n    return vue.unref(fixedColumnsOnLeft).length || vue.unref(fixedColumnsOnRight).length;\n  });\n  var columnsStyles = vue.computed(function () {\n    return vue.unref(_columns).reduce(function (style, column) {\n      style[column.key] = utils.calcColumnStyle(column, vue.unref(fixed), props.fixed);\n      return style;\n    }, {});\n  });\n  var columnsTotalWidth = vue.computed(function () {\n    return vue.unref(visibleColumns).reduce(function (width, column) {\n      return width + column.width;\n    }, 0);\n  });\n  var getColumn = function getColumn(key) {\n    return vue.unref(_columns).find(function (column) {\n      return column.key === key;\n    });\n  };\n  var getColumnStyle = function getColumnStyle(key) {\n    return vue.unref(columnsStyles)[key];\n  };\n  var updateColumnWidth = function updateColumnWidth(column, width) {\n    column.width = width;\n  };\n  function onColumnSorted(e) {\n    var _a;\n    var key = e.currentTarget.dataset.key;\n    if (!key) return;\n    var sortState = props.sortState,\n      sortBy = props.sortBy;\n    var order = constants.SortOrder.ASC;\n    if (shared.isObject(sortState)) {\n      order = constants.oppositeOrderMap[sortState[key]];\n    } else {\n      order = constants.oppositeOrderMap[sortBy.order];\n    }\n    (_a = props.onColumnSort) == null ? void 0 : _a.call(props, {\n      column: getColumn(key),\n      key: key,\n      order: order\n    });\n  }\n  return {\n    columns: _columns,\n    columnsStyles: columnsStyles,\n    columnsTotalWidth: columnsTotalWidth,\n    fixedColumnsOnLeft: fixedColumnsOnLeft,\n    fixedColumnsOnRight: fixedColumnsOnRight,\n    hasFixedColumns: hasFixedColumns,\n    mainColumns: mainColumns,\n    normalColumns: normalColumns,\n    visibleColumns: visibleColumns,\n    getColumn: getColumn,\n    getColumnStyle: getColumnStyle,\n    updateColumnWidth: updateColumnWidth,\n    onColumnSorted: onColumnSorted\n  };\n}\nexports.useColumns = useColumns;","map":{"version":3,"names":["useColumns","props","columns","fixed","_columns","vue","computed","unref","map","column","index","_a","_b","_objectSpread","key","dataKey","visibleColumns","filter","hidden","fixedColumnsOnLeft","fixedColumnsOnRight","normalColumns","mainColumns","ret","forEach","push","placeholderSign","_private","hasFixedColumns","length","columnsStyles","reduce","style","utils","calcColumnStyle","columnsTotalWidth","width","getColumn","find","getColumnStyle","updateColumnWidth","onColumnSorted","e","currentTarget","dataset","sortState","sortBy","order","constants","SortOrder","ASC","shared","isObject","oppositeOrderMap","onColumnSort","call"],"sources":["../../../../../../../packages/components/table-v2/src/composables/use-columns.ts"],"sourcesContent":["// @ts-nocheck\nimport { computed, unref } from 'vue'\nimport { isObject } from '@element-plus/utils'\nimport { SortOrder, oppositeOrderMap } from '../constants'\nimport { placeholderSign } from '../private'\nimport { calcColumnStyle } from './utils'\n\nimport type { CSSProperties, Ref } from 'vue'\nimport type { TableV2Props } from '../table'\nimport type { AnyColumns, Column, KeyType } from '../types'\n\nfunction useColumns(\n  props: TableV2Props,\n  columns: Ref<AnyColumns>,\n  fixed: Ref<boolean>\n) {\n  const _columns = computed(() =>\n    unref(columns).map((column, index) => ({\n      ...column,\n      key: column.key ?? column.dataKey ?? index,\n    }))\n  )\n\n  const visibleColumns = computed(() => {\n    return unref(_columns).filter((column) => !column.hidden)\n  })\n\n  const fixedColumnsOnLeft = computed(() =>\n    unref(visibleColumns).filter(\n      (column) => column.fixed === 'left' || column.fixed === true\n    )\n  )\n\n  const fixedColumnsOnRight = computed(() =>\n    unref(visibleColumns).filter((column) => column.fixed === 'right')\n  )\n\n  const normalColumns = computed(() =>\n    unref(visibleColumns).filter((column) => !column.fixed)\n  )\n\n  const mainColumns = computed(() => {\n    const ret: AnyColumns = []\n\n    unref(fixedColumnsOnLeft).forEach((column) => {\n      ret.push({\n        ...column,\n        placeholderSign,\n      })\n    })\n\n    unref(normalColumns).forEach((column) => {\n      ret.push(column)\n    })\n\n    unref(fixedColumnsOnRight).forEach((column) => {\n      ret.push({\n        ...column,\n        placeholderSign,\n      })\n    })\n\n    return ret\n  })\n\n  const hasFixedColumns = computed(() => {\n    return unref(fixedColumnsOnLeft).length || unref(fixedColumnsOnRight).length\n  })\n\n  const columnsStyles = computed(() => {\n    return unref(_columns).reduce<Record<Column<any>['key'], CSSProperties>>(\n      (style, column) => {\n        style[column.key] = calcColumnStyle(column, unref(fixed), props.fixed)\n        return style\n      },\n      {}\n    )\n  })\n\n  const columnsTotalWidth = computed(() => {\n    return unref(visibleColumns).reduce(\n      (width, column) => width + column.width,\n      0\n    )\n  })\n\n  const getColumn = (key: KeyType) => {\n    return unref(_columns).find((column) => column.key === key)\n  }\n\n  const getColumnStyle = (key: KeyType) => {\n    return unref(columnsStyles)[key]\n  }\n\n  const updateColumnWidth = (column: Column<any>, width: number) => {\n    column.width = width\n  }\n\n  function onColumnSorted(e: MouseEvent) {\n    const { key } = (e.currentTarget as HTMLElement).dataset\n    if (!key) return\n    const { sortState, sortBy } = props\n\n    let order = SortOrder.ASC\n\n    if (isObject(sortState)) {\n      order = oppositeOrderMap[sortState[key]]\n    } else {\n      order = oppositeOrderMap[sortBy.order]\n    }\n\n    props.onColumnSort?.({ column: getColumn(key)!, key, order })\n  }\n\n  return {\n    columns: _columns,\n    columnsStyles,\n    columnsTotalWidth,\n    fixedColumnsOnLeft,\n    fixedColumnsOnRight,\n    hasFixedColumns,\n    mainColumns,\n    normalColumns,\n    visibleColumns,\n\n    getColumn,\n    getColumnStyle,\n    updateColumnWidth,\n    onColumnSorted,\n  }\n}\n\nexport { useColumns }\nexport type UseColumnsReturn = ReturnType<typeof useColumns>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}