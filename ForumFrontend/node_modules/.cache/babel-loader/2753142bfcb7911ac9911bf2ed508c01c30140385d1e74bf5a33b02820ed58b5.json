{"ast":null,"code":"'use strict';\n\nrequire(\"core-js/modules/es.error.to-string.js\");\nrequire(\"core-js/modules/es.array.concat.js\");\nrequire(\"core-js/modules/es.array.every.js\");\nrequire(\"core-js/modules/es.array.filter.js\");\nrequire(\"core-js/modules/es.array.for-each.js\");\nrequire(\"core-js/modules/es.array.includes.js\");\nrequire(\"core-js/modules/es.array.map.js\");\nrequire(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/es.date.to-string.js\");\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.every.js\");\nrequire(\"core-js/modules/es.iterator.filter.js\");\nrequire(\"core-js/modules/es.iterator.for-each.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nrequire(\"core-js/modules/es.regexp.exec.js\");\nrequire(\"core-js/modules/es.regexp.to-string.js\");\nrequire(\"core-js/modules/es.string.includes.js\");\nrequire(\"core-js/modules/es.string.replace.js\");\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar transferPanel = require('../transfer-panel2.js');\nvar usePropsAlias = require('./use-props-alias.js');\nvar shared = require('@vue/shared');\nvar useCheck = function useCheck(props, panelState, emit) {\n  var propsAlias = usePropsAlias.usePropsAlias(props);\n  var filteredData = vue.computed(function () {\n    return props.data.filter(function (item) {\n      if (shared.isFunction(props.filterMethod)) {\n        return props.filterMethod(panelState.query, item);\n      } else {\n        var label = String(item[propsAlias.value.label] || item[propsAlias.value.key]);\n        return label.toLowerCase().includes(panelState.query.toLowerCase());\n      }\n    });\n  });\n  var checkableData = vue.computed(function () {\n    return filteredData.value.filter(function (item) {\n      return !item[propsAlias.value.disabled];\n    });\n  });\n  var checkedSummary = vue.computed(function () {\n    var checkedLength = panelState.checked.length;\n    var dataLength = props.data.length;\n    var _props$format = props.format,\n      noChecked = _props$format.noChecked,\n      hasChecked = _props$format.hasChecked;\n    if (noChecked && hasChecked) {\n      return checkedLength > 0 ? hasChecked.replace(/\\${checked}/g, checkedLength.toString()).replace(/\\${total}/g, dataLength.toString()) : noChecked.replace(/\\${total}/g, dataLength.toString());\n    } else {\n      return \"\".concat(checkedLength, \"/\").concat(dataLength);\n    }\n  });\n  var isIndeterminate = vue.computed(function () {\n    var checkedLength = panelState.checked.length;\n    return checkedLength > 0 && checkedLength < checkableData.value.length;\n  });\n  var updateAllChecked = function updateAllChecked() {\n    var checkableDataKeys = checkableData.value.map(function (item) {\n      return item[propsAlias.value.key];\n    });\n    panelState.allChecked = checkableDataKeys.length > 0 && checkableDataKeys.every(function (item) {\n      return panelState.checked.includes(item);\n    });\n  };\n  var handleAllCheckedChange = function handleAllCheckedChange(value) {\n    panelState.checked = value ? checkableData.value.map(function (item) {\n      return item[propsAlias.value.key];\n    }) : [];\n  };\n  vue.watch(function () {\n    return panelState.checked;\n  }, function (val, oldVal) {\n    updateAllChecked();\n    if (panelState.checkChangeByUser) {\n      var movedKeys = val.concat(oldVal).filter(function (v) {\n        return !val.includes(v) || !oldVal.includes(v);\n      });\n      emit(transferPanel.CHECKED_CHANGE_EVENT, val, movedKeys);\n    } else {\n      emit(transferPanel.CHECKED_CHANGE_EVENT, val);\n      panelState.checkChangeByUser = true;\n    }\n  });\n  vue.watch(checkableData, function () {\n    updateAllChecked();\n  });\n  vue.watch(function () {\n    return props.data;\n  }, function () {\n    var checked = [];\n    var filteredDataKeys = filteredData.value.map(function (item) {\n      return item[propsAlias.value.key];\n    });\n    panelState.checked.forEach(function (item) {\n      if (filteredDataKeys.includes(item)) {\n        checked.push(item);\n      }\n    });\n    panelState.checkChangeByUser = false;\n    panelState.checked = checked;\n  });\n  vue.watch(function () {\n    return props.defaultChecked;\n  }, function (val, oldVal) {\n    if (oldVal && val.length === oldVal.length && val.every(function (item) {\n      return oldVal.includes(item);\n    })) return;\n    var checked = [];\n    var checkableDataKeys = checkableData.value.map(function (item) {\n      return item[propsAlias.value.key];\n    });\n    val.forEach(function (item) {\n      if (checkableDataKeys.includes(item)) {\n        checked.push(item);\n      }\n    });\n    panelState.checkChangeByUser = false;\n    panelState.checked = checked;\n  }, {\n    immediate: true\n  });\n  return {\n    filteredData: filteredData,\n    checkableData: checkableData,\n    checkedSummary: checkedSummary,\n    isIndeterminate: isIndeterminate,\n    updateAllChecked: updateAllChecked,\n    handleAllCheckedChange: handleAllCheckedChange\n  };\n};\nexports.useCheck = useCheck;","map":{"version":3,"names":["useCheck","props","panelState","emit","propsAlias","usePropsAlias","filteredData","vue","computed","data","filter","item","shared","isFunction","filterMethod","query","label","String","value","key","toLowerCase","includes","checkableData","disabled","checkedSummary","checkedLength","checked","length","dataLength","_props$format","format","noChecked","hasChecked","replace","toString","concat","isIndeterminate","updateAllChecked","checkableDataKeys","map","allChecked","every","handleAllCheckedChange","watch","val","oldVal","checkChangeByUser","movedKeys","v","transferPanel","CHECKED_CHANGE_EVENT","filteredDataKeys","forEach","push","defaultChecked","immediate"],"sources":["../../../../../../../packages/components/transfer/src/composables/use-check.ts"],"sourcesContent":["import { computed, watch } from 'vue'\nimport { isFunction } from '@element-plus/utils'\nimport { CHECKED_CHANGE_EVENT } from '../transfer-panel'\nimport { usePropsAlias } from './use-props-alias'\n\nimport type { SetupContext } from 'vue'\nimport type { CheckboxValueType } from '@element-plus/components/checkbox'\nimport type { TransferKey } from '../transfer'\nimport type {\n  TransferPanelEmits,\n  TransferPanelProps,\n  TransferPanelState,\n} from '../transfer-panel'\n\nexport const useCheck = (\n  props: TransferPanelProps,\n  panelState: TransferPanelState,\n  emit: SetupContext<TransferPanelEmits>['emit']\n) => {\n  const propsAlias = usePropsAlias(props)\n\n  const filteredData = computed(() => {\n    return props.data.filter((item) => {\n      if (isFunction(props.filterMethod)) {\n        return props.filterMethod(panelState.query, item)\n      } else {\n        const label = String(\n          item[propsAlias.value.label] || item[propsAlias.value.key]\n        )\n        return label.toLowerCase().includes(panelState.query.toLowerCase())\n      }\n    })\n  })\n\n  const checkableData = computed(() =>\n    filteredData.value.filter((item) => !item[propsAlias.value.disabled])\n  )\n\n  const checkedSummary = computed(() => {\n    const checkedLength = panelState.checked.length\n    const dataLength = props.data.length\n    const { noChecked, hasChecked } = props.format\n\n    if (noChecked && hasChecked) {\n      return checkedLength > 0\n        ? hasChecked\n            .replace(/\\${checked}/g, checkedLength.toString())\n            .replace(/\\${total}/g, dataLength.toString())\n        : noChecked.replace(/\\${total}/g, dataLength.toString())\n    } else {\n      return `${checkedLength}/${dataLength}`\n    }\n  })\n\n  const isIndeterminate = computed(() => {\n    const checkedLength = panelState.checked.length\n    return checkedLength > 0 && checkedLength < checkableData.value.length\n  })\n\n  const updateAllChecked = () => {\n    const checkableDataKeys = checkableData.value.map(\n      (item) => item[propsAlias.value.key]\n    )\n    panelState.allChecked =\n      checkableDataKeys.length > 0 &&\n      checkableDataKeys.every((item) => panelState.checked.includes(item))\n  }\n\n  const handleAllCheckedChange = (value: CheckboxValueType) => {\n    panelState.checked = value\n      ? checkableData.value.map((item) => item[propsAlias.value.key])\n      : []\n  }\n\n  watch(\n    () => panelState.checked,\n    (val, oldVal) => {\n      updateAllChecked()\n\n      if (panelState.checkChangeByUser) {\n        const movedKeys = val\n          .concat(oldVal)\n          .filter((v) => !val.includes(v) || !oldVal.includes(v))\n        emit(CHECKED_CHANGE_EVENT, val, movedKeys)\n      } else {\n        emit(CHECKED_CHANGE_EVENT, val)\n        panelState.checkChangeByUser = true\n      }\n    }\n  )\n\n  watch(checkableData, () => {\n    updateAllChecked()\n  })\n\n  watch(\n    () => props.data,\n    () => {\n      const checked: TransferKey[] = []\n      const filteredDataKeys = filteredData.value.map(\n        (item) => item[propsAlias.value.key]\n      )\n      panelState.checked.forEach((item) => {\n        if (filteredDataKeys.includes(item)) {\n          checked.push(item)\n        }\n      })\n      panelState.checkChangeByUser = false\n      panelState.checked = checked\n    }\n  )\n\n  watch(\n    () => props.defaultChecked,\n    (val, oldVal) => {\n      if (\n        oldVal &&\n        val.length === oldVal.length &&\n        val.every((item) => oldVal.includes(item))\n      )\n        return\n\n      const checked: TransferKey[] = []\n      const checkableDataKeys = checkableData.value.map(\n        (item) => item[propsAlias.value.key]\n      )\n\n      val.forEach((item) => {\n        if (checkableDataKeys.includes(item)) {\n          checked.push(item)\n        }\n      })\n      panelState.checkChangeByUser = false\n      panelState.checked = checked\n    },\n    {\n      immediate: true,\n    }\n  )\n\n  return {\n    filteredData,\n    checkableData,\n    checkedSummary,\n    isIndeterminate,\n    updateAllChecked,\n    handleAllCheckedChange,\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}