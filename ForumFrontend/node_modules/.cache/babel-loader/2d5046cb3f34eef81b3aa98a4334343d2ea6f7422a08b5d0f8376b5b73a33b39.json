{"ast":null,"code":"import _regeneratorRuntime from \"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"H:/ForumServers/ForumFrontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/web.timers.js\";\nimport { computed, onMounted, watch, ref, provide } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter, useRoute } from 'vue-router';\nimport NotificationBell from '@/components/NotificationBell.vue';\nimport ChatWindow from '@/components/ChatWindow.vue';\nimport wsManager from '@/utils/websocket';\nimport { ElMessage } from 'element-plus';\nexport default {\n  name: 'App',\n  components: {\n    NotificationBell: NotificationBell,\n    ChatWindow: ChatWindow\n  },\n  setup: function setup() {\n    var store = useStore();\n    var router = useRouter();\n    var route = useRoute();\n\n    // 活跃聊天用户列表\n    var activeChatUsers = ref([]);\n\n    // 登录状态\n    var isLoggedIn = computed(function () {\n      return store.getters.isLoggedIn;\n    });\n    var isAdmin = computed(function () {\n      return store.getters.isAdmin;\n    });\n    var user = computed(function () {\n      return store.state.user;\n    });\n    var username = computed(function () {\n      return store.getters.username;\n    });\n    var userAvatar = computed(function () {\n      return store.getters.userAvatar;\n    });\n\n    // 检查通知功能是否可用\n    var notificationsEnabled = ref(false);\n\n    // 当前激活的路由\n    var activeRoute = computed(function () {\n      return route.path;\n    });\n\n    // 路由导航\n    var goToLogin = function goToLogin() {\n      return router.push('/login');\n    };\n    var goToRegister = function goToRegister() {\n      return router.push('/register');\n    };\n\n    // 强制刷新认证状态\n    var forceRefreshAuthState = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var token, userInfoStr, userInfo, _userInfo;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              console.log('强制刷新认证状态');\n              token = localStorage.getItem('token');\n              if (token) {\n                _context.next = 5;\n                break;\n              }\n              console.log('本地存储中没有token，不刷新认证状态');\n              return _context.abrupt(\"return\", false);\n            case 5:\n              // 同步token到store\n              store.commit('setToken', token);\n\n              // 尝试同步用户信息\n              try {\n                userInfoStr = localStorage.getItem('userInfo');\n                if (userInfoStr) {\n                  userInfo = JSON.parse(userInfoStr);\n                  store.commit('setUser', userInfo);\n                  console.log('已从localStorage同步用户信息:', userInfo);\n                }\n              } catch (e) {\n                console.error('解析本地用户信息失败:', e);\n              }\n\n              // 从API获取最新用户信息\n              _context.prev = 7;\n              _context.next = 10;\n              return store.dispatch('getUserInfo');\n            case 10:\n              _userInfo = _context.sent;\n              console.log('已从API更新用户信息:', _userInfo);\n              return _context.abrupt(\"return\", !!_userInfo);\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](7);\n              console.error('从API获取用户信息失败:', _context.t0);\n              return _context.abrupt(\"return\", false);\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[7, 15]]);\n      }));\n      return function forceRefreshAuthState() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    // 提供给子组件\n    provide('forceRefreshAuthState', forceRefreshAuthState);\n\n    // 处理下拉菜单命令\n    var handleCommand = function handleCommand(command) {\n      var _user$value, _store$state$user;\n      var userId;\n      switch (command) {\n        case 'profile':\n          // 确保用户ID存在\n          userId = ((_user$value = user.value) === null || _user$value === void 0 ? void 0 : _user$value.id) || ((_store$state$user = store.state.user) === null || _store$state$user === void 0 ? void 0 : _store$state$user.id);\n          if (userId) {\n            router.push(\"/profile/\".concat(userId));\n          } else {\n            console.error('无法获取用户ID');\n            ElMessage.error('获取用户信息失败');\n          }\n          break;\n        case 'messages':\n          router.push('/messages');\n          break;\n        case 'admin':\n          router.push('/admin');\n          break;\n        case 'logout':\n          logout();\n          break;\n      }\n    };\n\n    // 登出\n    var logout = function logout() {\n      // 关闭所有WebSocket连接\n      wsManager.closeAll();\n\n      // 登出并重定向到首页\n      store.dispatch('logout');\n      router.push('/');\n    };\n\n    // 打开聊天窗口\n    var openChatWindow = function openChatWindow(userId) {\n      if (!activeChatUsers.value.includes(userId)) {\n        activeChatUsers.value.push(userId);\n      }\n    };\n\n    // 关闭聊天窗口\n    var closeChatWindow = function closeChatWindow(userId) {\n      var index = activeChatUsers.value.indexOf(userId);\n      if (index !== -1) {\n        activeChatUsers.value.splice(index, 1);\n      }\n    };\n\n    // 初始化WebSocket连接\n    var initWebSockets = function initWebSockets() {\n      if (isLoggedIn.value) {\n        wsManager.init(store.state.token);\n      }\n    };\n\n    // 监听登录状态变化\n    watch(isLoggedIn, function (newValue) {\n      if (newValue) {\n        // 用户登录后初始化WebSocket\n        initWebSockets();\n      } else {\n        // 用户登出后关闭WebSocket\n        wsManager.closeAll();\n      }\n    });\n    onMounted(function () {\n      console.log('App组件加载 - 登录状态:', {\n        isLoggedIn: isLoggedIn.value,\n        token: store.state.token,\n        userInfo: user.value,\n        localStorageToken: localStorage.getItem('token'),\n        localStorageUserInfo: localStorage.getItem('userInfo')\n      });\n\n      // 创建全局聊天管理器，便于其他组件调用\n      window.chatManager = {\n        openChat: function openChat(userId) {\n          console.log('通过全局方法打开聊天窗口，userId:', userId);\n          openChatWindow(userId);\n        },\n        closeChat: function closeChat(userId) {\n          console.log('通过全局方法关闭聊天窗口，userId:', userId);\n          closeChatWindow(userId);\n        }\n      };\n\n      // 强制刷新用户状态\n      var token = localStorage.getItem('token');\n      if (token) {\n        console.log('App.vue - 应用启动时发现token，强制刷新用户状态');\n        store.commit('setToken', token);\n        try {\n          var userInfoStr = localStorage.getItem('userInfo');\n          if (userInfoStr) {\n            var userInfo = JSON.parse(userInfoStr);\n            store.commit('setUser', userInfo);\n            console.log('已从localStorage恢复用户信息:', userInfo);\n          }\n        } catch (e) {\n          console.error('解析用户信息失败:', e);\n        }\n\n        // 请求最新的用户信息\n        store.dispatch('getUserInfo').then(function (userInfo) {\n          console.log('用户信息已从API刷新:', userInfo);\n          // 强制触发状态更新\n          setTimeout(function () {\n            console.log('强制触发登录状态检查:', {\n              isLoggedIn: store.getters.isLoggedIn,\n              token: store.state.token,\n              userInfo: store.state.user\n            });\n          }, 100);\n        })[\"catch\"](function (err) {\n          console.error('刷新用户信息失败:', err);\n        });\n      }\n\n      // 页面加载时初始化WebSocket\n      initWebSockets();\n\n      // 检查通知API是否可用\n      fetch('http://localhost:8000/api/v1/notifications/').then(function (response) {\n        notificationsEnabled.value = response.status !== 404;\n        console.log('通知功能' + (notificationsEnabled.value ? '可用' : '不可用'));\n      })[\"catch\"](function () {\n        notificationsEnabled.value = false;\n        console.log('通知功能不可用 - 连接失败');\n      });\n\n      // 检查WebSocket是否可用\n      var testWs = new WebSocket(\"ws://localhost:8000/ws/notifications/?token=\".concat(store.state.token));\n      testWs.onopen = function () {\n        console.log('WebSocket连接成功');\n        testWs.close(); // 测试成功后关闭\n      };\n      testWs.onerror = function () {\n        console.log('WebSocket连接失败，禁用WebSocket通知功能');\n        // 可以在这里设置全局标志，禁用WebSocket功能\n        window.webSocketEnabled = false;\n      };\n    });\n    return {\n      isLoggedIn: isLoggedIn,\n      isAdmin: isAdmin,\n      user: user,\n      username: username,\n      userAvatar: userAvatar,\n      activeRoute: activeRoute,\n      activeChatUsers: activeChatUsers,\n      goToLogin: goToLogin,\n      goToRegister: goToRegister,\n      handleCommand: handleCommand,\n      openChatWindow: openChatWindow,\n      closeChatWindow: closeChatWindow,\n      notificationsEnabled: notificationsEnabled\n    };\n  }\n};","map":{"version":3,"names":["computed","onMounted","watch","ref","provide","useStore","useRouter","useRoute","NotificationBell","ChatWindow","wsManager","ElMessage","name","components","setup","store","router","route","activeChatUsers","isLoggedIn","getters","isAdmin","user","state","username","userAvatar","notificationsEnabled","activeRoute","path","goToLogin","push","goToRegister","forceRefreshAuthState","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","token","userInfoStr","userInfo","_userInfo","wrap","_callee$","_context","prev","next","console","log","localStorage","getItem","abrupt","commit","JSON","parse","e","error","dispatch","sent","t0","stop","apply","arguments","handleCommand","command","_user$value","_store$state$user","userId","value","id","concat","logout","closeAll","openChatWindow","includes","closeChatWindow","index","indexOf","splice","initWebSockets","init","newValue","localStorageToken","localStorageUserInfo","window","chatManager","openChat","closeChat","then","setTimeout","err","fetch","response","status","testWs","WebSocket","onopen","close","onerror","webSocketEnabled"],"sources":["H:\\ForumServers\\ForumFrontend\\src\\App.vue"],"sourcesContent":["<template>\n  <div id=\"app\">\n    <el-container>\n      <el-header>\n        <div class=\"header-content\">\n          <div class=\"logo\">\n            <router-link to=\"/\">论坛系统</router-link>\n          </div>\n          <div class=\"nav\">\n            <el-menu mode=\"horizontal\" :router=\"true\" :default-active=\"activeRoute\">\n              <el-menu-item index=\"/\">首页</el-menu-item>\n              <el-menu-item index=\"/boards\">板块</el-menu-item>\n              <el-menu-item index=\"/posts\">帖子</el-menu-item>\n              <el-menu-item index=\"/ranking\">排行榜</el-menu-item>\n              <el-menu-item index=\"/complaints\">投诉中心</el-menu-item>\n            </el-menu>\n          </div>\n          <div class=\"user-actions\">\n            <template v-if=\"isLoggedIn\">\n              <!-- 通知铃铛 -->\n              <NotificationBell v-if=\"notificationsEnabled\" />\n              \n              <!-- 用户头像和下拉菜单 -->\n              <el-dropdown trigger=\"click\" @command=\"handleCommand\">\n                <div class=\"user-avatar\">\n                  <el-avatar :size=\"32\" :src=\"userAvatar\">\n                    {{ username.substring(0, 1).toUpperCase() }}\n                  </el-avatar>\n                  <span class=\"username\">{{ user.nickname || user.username }}</span>\n                </div>\n                <template #dropdown>\n                  <el-dropdown-menu>\n                    <el-dropdown-item command=\"profile\">个人中心</el-dropdown-item>\n                    <el-dropdown-item command=\"messages\">我的私信</el-dropdown-item>\n                    <el-dropdown-item v-if=\"isAdmin\" command=\"admin\">管理后台</el-dropdown-item>\n                    <el-dropdown-item divided command=\"logout\">退出登录</el-dropdown-item>\n                  </el-dropdown-menu>\n                </template>\n              </el-dropdown>\n            </template>\n            <template v-else>\n              <el-button type=\"primary\" @click=\"goToLogin\">登录</el-button>\n              <el-button @click=\"goToRegister\">注册</el-button>\n            </template>\n          </div>\n        </div>\n      </el-header>\n      \n      <el-container class=\"main-container\">\n        <el-main>\n          <router-view />\n        </el-main>\n      </el-container>\n    \n    </el-container>\n    \n    <!-- 聊天窗口 -->\n    <div v-if=\"activeChatUsers.length > 0\" class=\"chat-windows-container\">\n      <ChatWindow \n        v-for=\"userId in activeChatUsers\"\n        :key=\"userId\"\n        :userId=\"userId\" \n        @close=\"closeChatWindow\" \n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { computed, onMounted, watch, ref, provide } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter, useRoute } from 'vue-router'\nimport NotificationBell from '@/components/NotificationBell.vue'\nimport ChatWindow from '@/components/ChatWindow.vue'\nimport wsManager from '@/utils/websocket'\nimport { ElMessage } from 'element-plus'\n\nexport default {\n  name: 'App',\n  components: {\n    NotificationBell,\n    ChatWindow\n  },\n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    const route = useRoute()\n    \n    // 活跃聊天用户列表\n    const activeChatUsers = ref([])\n    \n    // 登录状态\n    const isLoggedIn = computed(() => store.getters.isLoggedIn)\n    const isAdmin = computed(() => store.getters.isAdmin)\n    const user = computed(() => store.state.user)\n    const username = computed(() => store.getters.username)\n    const userAvatar = computed(() => store.getters.userAvatar)\n    \n    // 检查通知功能是否可用\n    const notificationsEnabled = ref(false)\n    \n    // 当前激活的路由\n    const activeRoute = computed(() => route.path)\n    \n    // 路由导航\n    const goToLogin = () => router.push('/login')\n    const goToRegister = () => router.push('/register')\n    \n    // 强制刷新认证状态\n    const forceRefreshAuthState = async () => {\n      console.log('强制刷新认证状态')\n      const token = localStorage.getItem('token')\n      if (!token) {\n        console.log('本地存储中没有token，不刷新认证状态')\n        return false\n      }\n\n      // 同步token到store\n      store.commit('setToken', token)\n      \n      // 尝试同步用户信息\n      try {\n        const userInfoStr = localStorage.getItem('userInfo')\n        if (userInfoStr) {\n          const userInfo = JSON.parse(userInfoStr)\n          store.commit('setUser', userInfo)\n          console.log('已从localStorage同步用户信息:', userInfo)\n        }\n      } catch (e) {\n        console.error('解析本地用户信息失败:', e)\n      }\n      \n      // 从API获取最新用户信息\n      try {\n        const userInfo = await store.dispatch('getUserInfo')\n        console.log('已从API更新用户信息:', userInfo)\n        return !!userInfo\n      } catch (err) {\n        console.error('从API获取用户信息失败:', err)\n        return false\n      }\n    }\n    \n    // 提供给子组件\n    provide('forceRefreshAuthState', forceRefreshAuthState)\n    \n    // 处理下拉菜单命令\n    const handleCommand = (command) => {\n      let userId;\n      \n      switch (command) {\n        case 'profile':\n          // 确保用户ID存在\n          userId = user.value?.id || store.state.user?.id;\n          if (userId) {\n            router.push(`/profile/${userId}`);\n          } else {\n            console.error('无法获取用户ID');\n            ElMessage.error('获取用户信息失败');\n          }\n          break;\n        case 'messages':\n          router.push('/messages');\n          break;\n        case 'admin':\n          router.push('/admin');\n          break;\n        case 'logout':\n          logout();\n          break;\n      }\n    }\n    \n    // 登出\n    const logout = () => {\n      // 关闭所有WebSocket连接\n      wsManager.closeAll()\n      \n      // 登出并重定向到首页\n      store.dispatch('logout')\n      router.push('/')\n    }\n    \n    // 打开聊天窗口\n    const openChatWindow = (userId) => {\n      if (!activeChatUsers.value.includes(userId)) {\n        activeChatUsers.value.push(userId)\n      }\n    }\n    \n    // 关闭聊天窗口\n    const closeChatWindow = (userId) => {\n      const index = activeChatUsers.value.indexOf(userId)\n      if (index !== -1) {\n        activeChatUsers.value.splice(index, 1)\n      }\n    }\n    \n    // 初始化WebSocket连接\n    const initWebSockets = () => {\n      if (isLoggedIn.value) {\n        wsManager.init(store.state.token)\n      }\n    }\n    \n    // 监听登录状态变化\n    watch(isLoggedIn, (newValue) => {\n      if (newValue) {\n        // 用户登录后初始化WebSocket\n        initWebSockets()\n      } else {\n        // 用户登出后关闭WebSocket\n        wsManager.closeAll()\n      }\n    })\n    \n    onMounted(() => {\n      console.log('App组件加载 - 登录状态:', {\n        isLoggedIn: isLoggedIn.value,\n        token: store.state.token,\n        userInfo: user.value,\n        localStorageToken: localStorage.getItem('token'),\n        localStorageUserInfo: localStorage.getItem('userInfo')\n      })\n      \n      // 创建全局聊天管理器，便于其他组件调用\n      window.chatManager = {\n        openChat: (userId) => {\n          console.log('通过全局方法打开聊天窗口，userId:', userId)\n          openChatWindow(userId)\n        },\n        closeChat: (userId) => {\n          console.log('通过全局方法关闭聊天窗口，userId:', userId)\n          closeChatWindow(userId)\n        }\n      }\n      \n      // 强制刷新用户状态\n      const token = localStorage.getItem('token')\n      if (token) {\n        console.log('App.vue - 应用启动时发现token，强制刷新用户状态')\n        store.commit('setToken', token)\n        try {\n          const userInfoStr = localStorage.getItem('userInfo')\n          if (userInfoStr) {\n            const userInfo = JSON.parse(userInfoStr)\n            store.commit('setUser', userInfo)\n            console.log('已从localStorage恢复用户信息:', userInfo)\n          }\n        } catch (e) {\n          console.error('解析用户信息失败:', e)\n        }\n        \n        // 请求最新的用户信息\n        store.dispatch('getUserInfo')\n          .then(userInfo => {\n            console.log('用户信息已从API刷新:', userInfo)\n            // 强制触发状态更新\n            setTimeout(() => {\n              console.log('强制触发登录状态检查:', {\n                isLoggedIn: store.getters.isLoggedIn,\n                token: store.state.token,\n                userInfo: store.state.user\n              })\n            }, 100)\n          })\n          .catch(err => {\n            console.error('刷新用户信息失败:', err)\n          })\n      }\n      \n      // 页面加载时初始化WebSocket\n      initWebSockets()\n      \n      // 检查通知API是否可用\n      fetch('http://localhost:8000/api/v1/notifications/')\n        .then(response => {\n          notificationsEnabled.value = response.status !== 404\n          console.log('通知功能' + (notificationsEnabled.value ? '可用' : '不可用'))\n        })\n        .catch(() => {\n          notificationsEnabled.value = false\n          console.log('通知功能不可用 - 连接失败')\n        })\n        \n      // 检查WebSocket是否可用\n      const testWs = new WebSocket(`ws://localhost:8000/ws/notifications/?token=${store.state.token}`)\n      testWs.onopen = () => {\n        console.log('WebSocket连接成功')\n        testWs.close() // 测试成功后关闭\n      }\n      testWs.onerror = () => {\n        console.log('WebSocket连接失败，禁用WebSocket通知功能')\n        // 可以在这里设置全局标志，禁用WebSocket功能\n        window.webSocketEnabled = false\n      }\n    })\n    \n    return {\n      isLoggedIn,\n      isAdmin,\n      user,\n      username,\n      userAvatar,\n      activeRoute,\n      activeChatUsers,\n      goToLogin,\n      goToRegister,\n      handleCommand,\n      openChatWindow,\n      closeChatWindow,\n      notificationsEnabled\n    }\n  }\n}\n</script>\n\n<style>\n#app {\n  font-family: 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  color: #2c3e50;\n  min-height: 100vh;\n}\n\n.el-container {\n  min-height: 100vh;\n}\n\n.el-header {\n  padding: 0;\n  background-color: #fff;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  position: fixed;\n  width: 100%;\n  z-index: 1000;\n}\n\n.header-content {\n  max-width: 1400px;\n  margin: 0 auto;\n  height: 60px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0 20px;\n}\n\n.logo {\n  font-size: 20px;\n  font-weight: bold;\n}\n\n.logo a {\n  color: #409EFF;\n  text-decoration: none;\n}\n\n.nav {\n  flex: 1;\n  margin: 0 20px;\n}\n\n.nav .el-menu {\n  border: none;\n  background: transparent;\n}\n\n.user-actions {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n\n.user-avatar {\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n}\n\n.username {\n  margin-left: 8px;\n  font-size: 14px;\n}\n\n.main-container {\n  padding-top: 60px;\n  min-height: calc(100vh - 60px);\n  background-color: #f5f7fa;\n}\n\n.el-main {\n  padding: 20px;\n}\n\n.el-footer {\n  height: 60px !important;\n  background-color: #fff;\n  border-top: 1px solid #e4e7ed;\n  margin-top: auto;\n}\n\n.footer-content {\n  max-width: 1400px;\n  margin: 0 auto;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #909399;\n}\n\n.chat-windows-container {\n  position: fixed;\n  bottom: 0;\n  right: 20px;\n  display: flex;\n  gap: 16px;\n  z-index: 1000;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}