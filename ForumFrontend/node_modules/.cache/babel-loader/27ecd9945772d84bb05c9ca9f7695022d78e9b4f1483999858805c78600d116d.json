{"ast":null,"code":"'use strict';\n\nrequire(\"core-js/modules/es.array.find-index.js\");\nrequire(\"core-js/modules/es.number.constructor.js\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar constants = require('./constants.js');\nvar error = require('../../../utils/error.js');\nvar types = require('../../../utils/types.js');\nvar useCarouselItem = function useCarouselItem(props) {\n  var carouselContext = vue.inject(constants.carouselContextKey);\n  var instance = vue.getCurrentInstance();\n  if (!carouselContext) {\n    error.debugWarn(constants.CAROUSEL_ITEM_NAME, \"usage: <el-carousel></el-carousel-item></el-carousel>\");\n  }\n  if (!instance) {\n    error.debugWarn(constants.CAROUSEL_ITEM_NAME, \"compositional hook can only be invoked inside setups\");\n  }\n  var carouselItemRef = vue.ref();\n  var hover = vue.ref(false);\n  var translate = vue.ref(0);\n  var scale = vue.ref(1);\n  var active = vue.ref(false);\n  var ready = vue.ref(false);\n  var inStage = vue.ref(false);\n  var animating = vue.ref(false);\n  var isCardType = carouselContext.isCardType,\n    isVertical = carouselContext.isVertical,\n    cardScale = carouselContext.cardScale;\n  function processIndex(index, activeIndex, length) {\n    var lastItemIndex = length - 1;\n    var prevItemIndex = activeIndex - 1;\n    var nextItemIndex = activeIndex + 1;\n    var halfItemIndex = length / 2;\n    if (activeIndex === 0 && index === lastItemIndex) {\n      return -1;\n    } else if (activeIndex === lastItemIndex && index === 0) {\n      return length;\n    } else if (index < prevItemIndex && activeIndex - index >= halfItemIndex) {\n      return length + 1;\n    } else if (index > nextItemIndex && index - activeIndex >= halfItemIndex) {\n      return -2;\n    }\n    return index;\n  }\n  function calcCardTranslate(index, activeIndex) {\n    var _a, _b;\n    var parentWidth = vue.unref(isVertical) ? ((_a = carouselContext.root.value) == null ? void 0 : _a.offsetHeight) || 0 : ((_b = carouselContext.root.value) == null ? void 0 : _b.offsetWidth) || 0;\n    if (inStage.value) {\n      return parentWidth * ((2 - cardScale) * (index - activeIndex) + 1) / 4;\n    } else if (index < activeIndex) {\n      return -(1 + cardScale) * parentWidth / 4;\n    } else {\n      return (3 + cardScale) * parentWidth / 4;\n    }\n  }\n  function calcTranslate(index, activeIndex, isVertical2) {\n    var rootEl = carouselContext.root.value;\n    if (!rootEl) return 0;\n    var distance = (isVertical2 ? rootEl.offsetHeight : rootEl.offsetWidth) || 0;\n    return distance * (index - activeIndex);\n  }\n  var translateItem = function translateItem(index, activeIndex, oldIndex) {\n    var _a;\n    var _isCardType = vue.unref(isCardType);\n    var carouselItemLength = (_a = carouselContext.items.value.length) != null ? _a : Number.NaN;\n    var isActive = index === activeIndex;\n    if (!_isCardType && !types.isUndefined(oldIndex)) {\n      animating.value = isActive || index === oldIndex;\n    }\n    if (!isActive && carouselItemLength > 2 && carouselContext.loop) {\n      index = processIndex(index, activeIndex, carouselItemLength);\n    }\n    var _isVertical = vue.unref(isVertical);\n    active.value = isActive;\n    if (_isCardType) {\n      inStage.value = Math.round(Math.abs(index - activeIndex)) <= 1;\n      translate.value = calcCardTranslate(index, activeIndex);\n      scale.value = vue.unref(active) ? 1 : cardScale;\n    } else {\n      translate.value = calcTranslate(index, activeIndex, _isVertical);\n    }\n    ready.value = true;\n    if (isActive && carouselItemRef.value) {\n      carouselContext.setContainerHeight(carouselItemRef.value.offsetHeight);\n    }\n  };\n  function handleItemClick() {\n    if (carouselContext && vue.unref(isCardType)) {\n      var index = carouselContext.items.value.findIndex(function (_ref) {\n        var uid = _ref.uid;\n        return uid === instance.uid;\n      });\n      carouselContext.setActiveItem(index);\n    }\n  }\n  vue.onMounted(function () {\n    carouselContext.addItem({\n      props: props,\n      states: vue.reactive({\n        hover: hover,\n        translate: translate,\n        scale: scale,\n        active: active,\n        ready: ready,\n        inStage: inStage,\n        animating: animating\n      }),\n      uid: instance.uid,\n      translateItem: translateItem\n    });\n  });\n  vue.onUnmounted(function () {\n    carouselContext.removeItem(instance.uid);\n  });\n  return {\n    carouselItemRef: carouselItemRef,\n    active: active,\n    animating: animating,\n    hover: hover,\n    inStage: inStage,\n    isVertical: isVertical,\n    translate: translate,\n    isCardType: isCardType,\n    scale: scale,\n    ready: ready,\n    handleItemClick: handleItemClick\n  };\n};\nexports.useCarouselItem = useCarouselItem;","map":{"version":3,"names":["useCarouselItem","props","carouselContext","vue","inject","constants","carouselContextKey","instance","getCurrentInstance","error","debugWarn","CAROUSEL_ITEM_NAME","carouselItemRef","ref","hover","translate","scale","active","ready","inStage","animating","isCardType","isVertical","cardScale","processIndex","index","activeIndex","length","lastItemIndex","prevItemIndex","nextItemIndex","halfItemIndex","calcCardTranslate","_a","_b","parentWidth","unref","root","value","offsetHeight","offsetWidth","calcTranslate","isVertical2","rootEl","distance","translateItem","oldIndex","_isCardType","carouselItemLength","items","Number","NaN","isActive","types","isUndefined","loop","_isVertical","Math","round","abs","setContainerHeight","handleItemClick","findIndex","_ref","uid","setActiveItem","onMounted","addItem","states","reactive","onUnmounted","removeItem"],"sources":["../../../../../../packages/components/carousel/src/use-carousel-item.ts"],"sourcesContent":["import {\n  getCurrentInstance,\n  inject,\n  onMounted,\n  onUnmounted,\n  reactive,\n  ref,\n  unref,\n} from 'vue'\nimport { debugWarn, isUndefined } from '@element-plus/utils'\nimport { CAROUSEL_ITEM_NAME, carouselContextKey } from './constants'\n\nimport type { CarouselItemProps } from './carousel-item'\n\nexport const useCarouselItem = (props: CarouselItemProps) => {\n  const carouselContext = inject(carouselContextKey)!\n  // instance\n  const instance = getCurrentInstance()!\n  if (!carouselContext) {\n    debugWarn(\n      CAROUSEL_ITEM_NAME,\n      'usage: <el-carousel></el-carousel-item></el-carousel>'\n    )\n  }\n\n  if (!instance) {\n    debugWarn(\n      CAROUSEL_ITEM_NAME,\n      'compositional hook can only be invoked inside setups'\n    )\n  }\n\n  const carouselItemRef = ref<HTMLElement>()\n  const hover = ref(false)\n  const translate = ref(0)\n  const scale = ref(1)\n  const active = ref(false)\n  const ready = ref(false)\n  const inStage = ref(false)\n  const animating = ref(false)\n\n  // computed\n  const { isCardType, isVertical, cardScale } = carouselContext\n\n  // methods\n\n  function processIndex(index: number, activeIndex: number, length: number) {\n    const lastItemIndex = length - 1\n    const prevItemIndex = activeIndex - 1\n    const nextItemIndex = activeIndex + 1\n    const halfItemIndex = length / 2\n\n    if (activeIndex === 0 && index === lastItemIndex) {\n      return -1\n    } else if (activeIndex === lastItemIndex && index === 0) {\n      return length\n    } else if (index < prevItemIndex && activeIndex - index >= halfItemIndex) {\n      return length + 1\n    } else if (index > nextItemIndex && index - activeIndex >= halfItemIndex) {\n      return -2\n    }\n    return index\n  }\n\n  function calcCardTranslate(index: number, activeIndex: number) {\n    const parentWidth = unref(isVertical)\n      ? carouselContext.root.value?.offsetHeight || 0\n      : carouselContext.root.value?.offsetWidth || 0\n\n    if (inStage.value) {\n      return (parentWidth * ((2 - cardScale) * (index - activeIndex) + 1)) / 4\n    } else if (index < activeIndex) {\n      return (-(1 + cardScale) * parentWidth) / 4\n    } else {\n      return ((3 + cardScale) * parentWidth) / 4\n    }\n  }\n\n  function calcTranslate(\n    index: number,\n    activeIndex: number,\n    isVertical: boolean\n  ) {\n    const rootEl = carouselContext.root.value\n    if (!rootEl) return 0\n\n    const distance =\n      (isVertical ? rootEl.offsetHeight : rootEl.offsetWidth) || 0\n    return distance * (index - activeIndex)\n  }\n\n  const translateItem = (\n    index: number,\n    activeIndex: number,\n    oldIndex?: number\n  ) => {\n    const _isCardType = unref(isCardType)\n    const carouselItemLength = carouselContext.items.value.length ?? Number.NaN\n\n    const isActive = index === activeIndex\n    if (!_isCardType && !isUndefined(oldIndex)) {\n      animating.value = isActive || index === oldIndex\n    }\n\n    if (!isActive && carouselItemLength > 2 && carouselContext.loop) {\n      index = processIndex(index, activeIndex, carouselItemLength)\n    }\n\n    const _isVertical = unref(isVertical)\n    active.value = isActive\n\n    if (_isCardType) {\n      inStage.value = Math.round(Math.abs(index - activeIndex)) <= 1\n      translate.value = calcCardTranslate(index, activeIndex)\n      scale.value = unref(active) ? 1 : cardScale\n    } else {\n      translate.value = calcTranslate(index, activeIndex, _isVertical)\n    }\n\n    ready.value = true\n\n    if (isActive && carouselItemRef.value) {\n      carouselContext.setContainerHeight(carouselItemRef.value.offsetHeight)\n    }\n  }\n\n  function handleItemClick() {\n    if (carouselContext && unref(isCardType)) {\n      const index = carouselContext.items.value.findIndex(\n        ({ uid }) => uid === instance.uid\n      )\n      carouselContext.setActiveItem(index)\n    }\n  }\n\n  // lifecycle\n  onMounted(() => {\n    carouselContext.addItem({\n      props,\n      states: reactive({\n        hover,\n        translate,\n        scale,\n        active,\n        ready,\n        inStage,\n        animating,\n      }),\n      uid: instance.uid,\n      translateItem,\n    })\n  })\n\n  onUnmounted(() => {\n    carouselContext.removeItem(instance.uid)\n  })\n\n  return {\n    carouselItemRef,\n    active,\n    animating,\n    hover,\n    inStage,\n    isVertical,\n    translate,\n    isCardType,\n    scale,\n    ready,\n    handleItemClick,\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}